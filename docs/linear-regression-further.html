<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>linear-regression-further</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-beb392ddb238527d957dbf35687def22.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear-regression.html">8. Regresson modelling</a></li><li class="breadcrumb-item"><a href="./linear-regression-further.html">8.2. Linear regression II</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./website-information.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to use this website</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Probability sampling</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">2. Introducing SPSS &amp; preparing data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction-to-spss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.1. Introducing SPSS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preparing-a-dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.2. Preparing a dataset</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sample-description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Data exploration &amp; sample description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./population-description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Population description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sample-size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Sample size calculations</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">6. Bivariate tests for numerical variables</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./independent-t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.1. Independent t-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./independent-t-test-skewed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.2. Independent t-test with skewed data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./paired-t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.3. Paired t-test</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">7. Bivariate tests for categorical variables</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi-sq-independence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.1. Chi-square test of independence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi-sq-goodness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.2. Chi-square goodness of fit test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./paired-categorical-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.3. Paired categorical variable test (McNemar’s test)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">8. Regresson modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.1. Linear regression I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression-further.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">8.2. Linear regression II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.3. Logistic regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complex-sampling-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Complex sampling design analysis</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#multiple-linear-regression-interactions-non-linear-associations" id="toc-multiple-linear-regression-interactions-non-linear-associations" class="nav-link active" data-scroll-target="#multiple-linear-regression-interactions-non-linear-associations">Multiple linear regression interactions &amp; non-linear associations</a></li>
  <li><a href="#rationale" id="toc-rationale" class="nav-link" data-scroll-target="#rationale">Rationale</a>
  <ul class="collapse">
  <li><a href="#uses" id="toc-uses" class="nav-link" data-scroll-target="#uses">Uses</a></li>
  <li><a href="#key-terminology-and-concepts" id="toc-key-terminology-and-concepts" class="nav-link" data-scroll-target="#key-terminology-and-concepts">Key terminology and concepts</a></li>
  </ul></li>
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice">Practice</a>
  <ul class="collapse">
  <li><a href="#scenario" id="toc-scenario" class="nav-link" data-scroll-target="#scenario">Scenario</a></li>
  <li><a href="#exercise-1-to-explore-how-we-can-describe-categorical-by-categorical-interactions-we-will-describe-the-population-level-association-between-sex-femalemale-and-smoking-status-noyes-combined-subgroups-our-covariates-and-systolic-blood-pressure-mmhg---our-outcome-using-linear-regression." id="toc-exercise-1-to-explore-how-we-can-describe-categorical-by-categorical-interactions-we-will-describe-the-population-level-association-between-sex-femalemale-and-smoking-status-noyes-combined-subgroups-our-covariates-and-systolic-blood-pressure-mmhg---our-outcome-using-linear-regression." class="nav-link" data-scroll-target="#exercise-1-to-explore-how-we-can-describe-categorical-by-categorical-interactions-we-will-describe-the-population-level-association-between-sex-femalemale-and-smoking-status-noyes-combined-subgroups-our-covariates-and-systolic-blood-pressure-mmhg---our-outcome-using-linear-regression.">Exercise 1: to explore how we can describe categorical by categorical interactions, we will describe the population-level association between sex (female/male) and smoking status (no/yes) combined subgroups (our covariates) and systolic blood pressure (mmHg - our outcome) using linear regression.</a>
  <ul class="collapse">
  <li><a href="#step-1-explore-the-data" id="toc-step-1-explore-the-data" class="nav-link" data-scroll-target="#step-1-explore-the-data">Step 1: explore the data</a></li>
  <li><a href="#step-2-run-the-linear-regression-model" id="toc-step-2-run-the-linear-regression-model" class="nav-link" data-scroll-target="#step-2-run-the-linear-regression-model">Step 2: run the linear regression model</a></li>
  <li><a href="#step-3-check-the-assumptions-of-linear-regression" id="toc-step-3-check-the-assumptions-of-linear-regression" class="nav-link" data-scroll-target="#step-3-check-the-assumptions-of-linear-regression">Step 3: check the assumptions of linear regression</a></li>
  <li><a href="#step-4-consider-additional-possible-issues-before-interpreting-the-results" id="toc-step-4-consider-additional-possible-issues-before-interpreting-the-results" class="nav-link" data-scroll-target="#step-4-consider-additional-possible-issues-before-interpreting-the-results">Step 4: consider additional possible issues (before interpreting the results)</a></li>
  <li><a href="#step-5-understand-the-results-tables-and-extract-the-key-results" id="toc-step-5-understand-the-results-tables-and-extract-the-key-results" class="nav-link" data-scroll-target="#step-5-understand-the-results-tables-and-extract-the-key-results">Step 5: understand the results tables and extract the key results</a></li>
  </ul></li>
  <li><a href="#exercise-2-to-explore-how-we-can-describe-continuous-by-categorical-interactions-we-will-describe-how-the-population-level-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-sex-femalemale-using-linear-regression.-note-you-could-equally-frame-this-question-as-looking-how-the-association-between-sex-and-systolic-blood-pressure-varies-by-age.-its-two-sides-of-the-same-coin." id="toc-exercise-2-to-explore-how-we-can-describe-continuous-by-categorical-interactions-we-will-describe-how-the-population-level-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-sex-femalemale-using-linear-regression.-note-you-could-equally-frame-this-question-as-looking-how-the-association-between-sex-and-systolic-blood-pressure-varies-by-age.-its-two-sides-of-the-same-coin." class="nav-link" data-scroll-target="#exercise-2-to-explore-how-we-can-describe-continuous-by-categorical-interactions-we-will-describe-how-the-population-level-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-sex-femalemale-using-linear-regression.-note-you-could-equally-frame-this-question-as-looking-how-the-association-between-sex-and-systolic-blood-pressure-varies-by-age.-its-two-sides-of-the-same-coin.">Exercise 2: to explore how we can describe continuous by categorical interactions, we will describe how the population-level association between age (years) and systolic blood pressure (mmHg - our outcome) varies by sex (female/male) using linear regression. Note, you could equally frame this question as looking how the association between sex and systolic blood pressure varies by age. It’s “two sides of the same coin”.</a>
  <ul class="collapse">
  <li><a href="#step-1-explore-the-data-1" id="toc-step-1-explore-the-data-1" class="nav-link" data-scroll-target="#step-1-explore-the-data-1">Step 1: explore the data</a></li>
  <li><a href="#step-2-run-the-regression-model" id="toc-step-2-run-the-regression-model" class="nav-link" data-scroll-target="#step-2-run-the-regression-model">Step 2: run the regression model</a></li>
  <li><a href="#step-3-check-the-assumptions" id="toc-step-3-check-the-assumptions" class="nav-link" data-scroll-target="#step-3-check-the-assumptions">Step 3: check the assumptions</a></li>
  <li><a href="#step-4-consider-additional-possible-issues" id="toc-step-4-consider-additional-possible-issues" class="nav-link" data-scroll-target="#step-4-consider-additional-possible-issues">Step 4: consider additional possible issues</a></li>
  <li><a href="#step-5-understand-the-results-tables-and-extract-the-key-results-1" id="toc-step-5-understand-the-results-tables-and-extract-the-key-results-1" class="nav-link" data-scroll-target="#step-5-understand-the-results-tables-and-extract-the-key-results-1">Step 5: understand the results tables and extract the key results</a></li>
  </ul></li>
  <li><a href="#exercise-3-to-explore-how-we-can-describe-continuous-by-continuous-interactions-we-will-describe-how-the-population-level-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-bmi-kgm2-or-equivalently-how-how-the-population-level-association-between-bmi-kgm2-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-age-years-using-linear-regression.-again-this-is-two-sides-of-the-same-coin." id="toc-exercise-3-to-explore-how-we-can-describe-continuous-by-continuous-interactions-we-will-describe-how-the-population-level-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-bmi-kgm2-or-equivalently-how-how-the-population-level-association-between-bmi-kgm2-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-age-years-using-linear-regression.-again-this-is-two-sides-of-the-same-coin." class="nav-link" data-scroll-target="#exercise-3-to-explore-how-we-can-describe-continuous-by-continuous-interactions-we-will-describe-how-the-population-level-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-bmi-kgm2-or-equivalently-how-how-the-population-level-association-between-bmi-kgm2-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-age-years-using-linear-regression.-again-this-is-two-sides-of-the-same-coin.">Exercise 3: to explore how we can describe continuous by continuous interactions, we will describe how the population-level association between age (years) and systolic blood pressure (mmHg - our outcome) varies by BMI (kg/m2), or equivalently how how the population-level association between BMI (kg/m2) and systolic blood pressure (mmHg - our outcome) varies by age (years), using linear regression. Again, this is “two sides of the same coin”.</a>
  <ul class="collapse">
  <li><a href="#step-1-explore-the-data-2" id="toc-step-1-explore-the-data-2" class="nav-link" data-scroll-target="#step-1-explore-the-data-2">Step 1: explore the data</a></li>
  <li><a href="#step-2-run-the-regression-model-1" id="toc-step-2-run-the-regression-model-1" class="nav-link" data-scroll-target="#step-2-run-the-regression-model-1">Step 2: run the regression model</a></li>
  <li><a href="#step-3-check-the-assumptions-1" id="toc-step-3-check-the-assumptions-1" class="nav-link" data-scroll-target="#step-3-check-the-assumptions-1">Step 3: check the assumptions</a></li>
  <li><a href="#step-4-consider-additional-possible-issues-1" id="toc-step-4-consider-additional-possible-issues-1" class="nav-link" data-scroll-target="#step-4-consider-additional-possible-issues-1">Step 4: consider additional possible issues</a></li>
  <li><a href="#step-5-understand-the-results-tables-and-extract-the-key-results-2" id="toc-step-5-understand-the-results-tables-and-extract-the-key-results-2" class="nav-link" data-scroll-target="#step-5-understand-the-results-tables-and-extract-the-key-results-2">Step 5: understand the results tables and extract the key results</a></li>
  </ul></li>
  <li><a href="#exercise-4-to-explore-how-we-can-describe-non-linear-associations-between-continuousdiscrete-covariates-and-continuous-outcomes-we-will-describe-the-population-level-non-linear-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome." id="toc-exercise-4-to-explore-how-we-can-describe-non-linear-associations-between-continuousdiscrete-covariates-and-continuous-outcomes-we-will-describe-the-population-level-non-linear-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome." class="nav-link" data-scroll-target="#exercise-4-to-explore-how-we-can-describe-non-linear-associations-between-continuousdiscrete-covariates-and-continuous-outcomes-we-will-describe-the-population-level-non-linear-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome.">Exercise 4: to explore how we can describe non-linear associations between continuous/discrete covariates and continuous outcomes, we will describe the population-level non-linear association between age (years) and systolic blood pressure (mmHg - our outcome).</a>
  <ul class="collapse">
  <li><a href="#step-1-explore-the-data-3" id="toc-step-1-explore-the-data-3" class="nav-link" data-scroll-target="#step-1-explore-the-data-3">Step 1: explore the data</a></li>
  <li><a href="#step-2-run-the-regression-model-2" id="toc-step-2-run-the-regression-model-2" class="nav-link" data-scroll-target="#step-2-run-the-regression-model-2">Step 2: run the regression model</a></li>
  <li><a href="#step-3-check-the-assumptions-2" id="toc-step-3-check-the-assumptions-2" class="nav-link" data-scroll-target="#step-3-check-the-assumptions-2">Step 3: check the assumptions</a></li>
  <li><a href="#step-4-consider-additional-possible-issues-2" id="toc-step-4-consider-additional-possible-issues-2" class="nav-link" data-scroll-target="#step-4-consider-additional-possible-issues-2">Step 4: consider additional possible issues</a></li>
  <li><a href="#step-5-understand-the-results-tables-and-extract-the-key-results-3" id="toc-step-5-understand-the-results-tables-and-extract-the-key-results-3" class="nav-link" data-scroll-target="#step-5-understand-the-results-tables-and-extract-the-key-results-3">Step 5: understand the results tables and extract the key results</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear-regression.html">8. Regresson modelling</a></li><li class="breadcrumb-item"><a href="./linear-regression-further.html">8.2. Linear regression II</a></li></ol></nav></header>




<section id="multiple-linear-regression-interactions-non-linear-associations" class="level1">
<h1>Multiple linear regression interactions &amp; non-linear associations</h1>
<hr>
<p>In this practical we will look at how we can use linear regression with interactions to describe more complicated associations between two covariates and a continuous outcome.</p>
<p><br></p>
</section>
<section id="rationale" class="level1">
<h1>Rationale</h1>
<hr>
<section id="uses" class="level2">
<h2 class="anchored" data-anchor-id="uses">Uses</h2>
<p>Previously we saw how we can use linear regression to describe associations between continuous, discrete or categorical covariates and continuous outcomes (and sometimes also discrete outcomes, if the modelling assumptions are not too badly violated), but we only looked at describing bivariate associations. Here, we look at how we can describe interactions between two covariates or non-linear associations to describe more complicated associations that often exist.</p>
</section>
<section id="key-terminology-and-concepts" class="level2">
<h2 class="anchored" data-anchor-id="key-terminology-and-concepts">Key terminology and concepts</h2>
<ul>
<li><p><strong>Interaction</strong> = When the size and/or direction of a association between one covariate and an outcome depends on the value of another covariate (or vice versa).</p></li>
<li><p><strong>Non-linear association</strong> = A association between a continuous/discrete covariate and a continuous/potentially discrete outcome that is not linear (i.e.&nbsp;not a straight line), or that you do not want to assume is linear. Therefore, within a linear regression modelling context such a association cannot be modelled using a single coefficient and requires polynomial terms for the covariate of interest.</p></li>
<li><p><strong>Polynomial terms</strong> = A continuous or discrete covariate with an exponent/power, e.g.&nbsp;age-squared, age-cubed etc.</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="practice" class="level1">
<h1>Practice</h1>
<hr>
<section id="scenario" class="level2">
<h2 class="anchored" data-anchor-id="scenario">Scenario</h2>
<p>We wish to describe important and potentially complex associations between key socio-demographic and relevant health related characteristics and individuals’ systolic blood pressure using the data collected in the “SBP int &amp; nl” dataset. Interactions and non-linear associations are often subtle/weak so the interactions and non-linear associations in this dataset have been created to clearly illustrate these types of associations.</p>
<p>As these are descriptive research questions and we want to describe the associations of interest as they exist (to inform policy and practice), we will use repeated linear regression models where we model the associations of interest without adjusting for any other covariates.</p>
</section>
<section id="exercise-1-to-explore-how-we-can-describe-categorical-by-categorical-interactions-we-will-describe-the-population-level-association-between-sex-femalemale-and-smoking-status-noyes-combined-subgroups-our-covariates-and-systolic-blood-pressure-mmhg---our-outcome-using-linear-regression." class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-to-explore-how-we-can-describe-categorical-by-categorical-interactions-we-will-describe-the-population-level-association-between-sex-femalemale-and-smoking-status-noyes-combined-subgroups-our-covariates-and-systolic-blood-pressure-mmhg---our-outcome-using-linear-regression.">Exercise 1: to explore how we can describe categorical by categorical interactions, we will describe the population-level association between sex (female/male) and smoking status (no/yes) combined subgroups (our covariates) and systolic blood pressure (mmHg - our outcome) using linear regression.</h2>
<ul>
<li>Load the “SBP int &amp; nl.sav” dataset.</li>
</ul>
<section id="step-1-explore-the-data" class="level3">
<h3 class="anchored" data-anchor-id="step-1-explore-the-data">Step 1: explore the data</h3>
<p><strong>Written instructions: explore the data</strong></p>
<details>
<summary>
Read/hide
</summary>
<p>Again, it recommended to thoroughly explore you data in terms of: 1) the distribution of your outcome and covariates, to ensure you understand them well and are taking a suitable modelling approach (e.g.&nbsp;linear regression rather than another type of regression), and 2) what functional form of model makes good sense given the associations between your covariate(s) and outcome variable(s) - particularly whether there are any clear/strong interactions or non-linear associations, which we will look at here.</p>
<section id="univariate-exploration" class="level4">
<h4 class="anchored" data-anchor-id="univariate-exploration">Univariate exploration</h4>
<p>To understand the distribution of your variables you can use histograms and boxplots for numerical variables and barcharts for categorical variables. Let’s run a histogram for our outcome variable.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Histograms</mark>. Add sbp_sex_smoke into the <mark>Variable:</mark> box, tick the <mark>Display normal curve</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>The overall distribution appears to be bimodal - i.e.&nbsp;there are two peaks. This is often indicative of there being two separate and distinct groups within the data that systematically differ in terms of their outcome values.</p>
<p>Next, let’s look at a bar chart for our sex and smoke variables.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Bar</mark>. Then click the <mark>Simple</mark> option and <mark>Define</mark>. Add the variable sex to the <mark>Category axis:</mark> box, and within the <mark>Bars represent</mark> area tick the <mark>% of cases</mark> option and click <mark>OK</mark>. What do you see? Repeat for the smoke variable.</li>
</ul>
<p>Sex is perfectly equally distributed, i.e.&nbsp;50:50, but only 20% of participants are smokers.</p>
</section>
<section id="bivariate-exploration" class="level4">
<h4 class="anchored" data-anchor-id="bivariate-exploration">Bivariate exploration</h4>
<p>First, let’s explore the distribution of sex and smoking status together. This is visualising a cross-tabulation of the two variables.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Bar</mark>. Then click the <mark>Simple</mark> option and <mark>Define</mark>. Add the variable sex_smoke to the <mark>Category axis:</mark> box, and within the <mark>Bars represent</mark> area tick the <mark>% of cases</mark> option and click <mark>OK</mark>. Note: it seems to be pretty tricky to create such combined variables in SPSS so I actually just did this in another software package, but you could do it easily enough in Excel too using the CONCAT function.</li>
</ul>
<p>The female smoker group is half the size of the male smoker group.</p>
<p>Next let’s look at the distribution of the outcome in relation to the four subgroups of interest (female-non-smoke, female-smoker, male-non-smoker, male-smoker). We will use a boxplot to display the median, interquartile range and outliers for systolic blood pressure values in each subgroup.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Boxplot</mark>. Then select the <mark>Simple</mark> option and click <mark>Define</mark>. Add the sbp_sex_smoke variable into the <mark>Variable:</mark> box and the sex_smoke variable into the <mark>Category Axis:</mark> box and then click <mark>OK</mark>.</li>
</ul>
<p>It looks like median systolic blood pressure is lowest and roughly equal for female and male non-smokers and higher for both female and male smokers, but with male smokers having slightly higher median systolic blood pressure than female smokers.</p>
</section>
</details></section>
<section id="step-2-run-the-linear-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="step-2-run-the-linear-regression-model">Step 2: run the linear regression model</h3>
<p>Sorry there are no video-based instructions.</p>
<p><strong>Written instructions: run the linear regression model</strong></p>
<details>
<summary>
Read/hide
</summary>
<p>Remember linear regression allows you to look at associations between a numerical outcome variable and any number of numerical or categorical covariates, assuming all the assumptions of the method are met (we’ll check these out shortly). So let’s see how we build, run and estimate our linear regression model in SPSS.</p>
<ul>
<li><p>From the main menu go: <mark>Analyze &gt; General Linear Model &gt; Univariate</mark>.</p></li>
<li><p>Next, in the <mark>Univariate</mark> tool we add our outcome variable sbp_sex_smoke to the <mark>Dependent Variable:</mark> box. Then we add our covariate of sex_smoke to the <mark>Fixed factors:</mark> box. We can ignore everything else.</p></li>
<li><p>Next, click the <mark>Contrasts</mark> button and in the <mark>Change Contrast</mark> area set <mark>Contrast:</mark> to “Repeated”.</p></li>
<li><p>Next, click the <mark>Save</mark> button and under <mark>Predicted Values</mark> tick the <mark>Unstandardized</mark> box, and then under <mark>Residuals</mark> tick the <mark>Unstandardized</mark> box, and then under <mark>Diagnostics</mark> tick the box for <mark>Cook’s distance</mark>.</p></li>
<li><p>Lastly, click the <mark>Options</mark> button, and then under <mark>Display</mark> tick the <mark>Parameter estimates</mark> box and click <mark>Continue</mark> and then <mark>OK</mark>. The output window will then pop up with the results, but first…</p></li>
</ul>
</details>
</section>
<section id="step-3-check-the-assumptions-of-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="step-3-check-the-assumptions-of-linear-regression">Step 3: check the assumptions of linear regression</h3>
<p>Before we look at the results that appear in the output window we must first check whether we can treat the results as robust and valid. Our results are only potentially valid if the assumptions of the linear regression model have been met/hold, i.e.&nbsp;if they have not been violated. When it comes to interpretation we would of course have to consider all other potential sources of bias. Below we’ll just list the modelling assumptions (see the previous linear regression practical for more details) and how to check them.</p>
<p><strong>1. Continuous outcome</strong></p>
<p>We know by definition the outcome is continuous.</p>
<p><strong>2. Independent observations</strong></p>
<p>We know based on the study design, specifically the sampling design, that we have a simple random sample.</p>
<p><strong>3. Normally distributed residuals</strong></p>
<p>We can again plot a histogram of our residuals to assess the approximately.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Histogram</mark>. Then add the RES_1 variable into the <mark>Variable:</mark> box (note: if you run further models the subsequent residual variables will be automatically named RES_2, RES_3 and so on - we will therefore refer to subsequent residual variables as RES_X, with X being an unknown number depending on how many models you have run), tick the <mark>Display normal curve</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>The residuals appear to be very reasonably approximately normal so we can safely assume this assumption has not been violated in our model.</p>
<p><strong>4. Linearity of the associations between the residuals and the numerical variable(s)</strong></p>
<p>This assumption does not apply to this model as we only have a single categorical covariate. It would only apply when continuous/discrete covariates are involved.</p>
<p><strong>5. Homoscedasticity: constant variance of the residuals across model predicted values</strong></p>
<p>We can again plot the residuals against predicted/fitted values, but as we just have one covariate with four groups we won’t see a cloud of points but instead four separate lines of points. This is because the model only includes one categorical covariate with four groups and so the model can only predict four possible distinct values depending on the group we are predicting a mean outcome for. However, we can still compare whether the spread of the residuals is approximately equal for each group.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Scatter/Dot</mark>, then select <mark>Simple Scatter</mark> and click <mark>Define</mark>. Add the RES_1 variable into the <mark>Y Axis:</mark> box and the PRE_1 variable into the <mark>X Axis:</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>There does not appear to be any clear and substantial difference in the spread of the residuals at each predicted value.</p>
</section>
<section id="step-4-consider-additional-possible-issues-before-interpreting-the-results" class="level3">
<h3 class="anchored" data-anchor-id="step-4-consider-additional-possible-issues-before-interpreting-the-results">Step 4: consider additional possible issues (before interpreting the results)</h3>
<p><strong>No extremely influential observations</strong></p>
<p>Again, we will create a scatterplot of Cook’s D against the observation ID variable (which is just a simple count from the first to the last observation).</p>
<ul>
<li>Remember in the main menu we go: <mark>Graphs &gt; Scatter/Dot</mark>. Then select the <mark>Simple Scatter</mark> option and click <mark>Define</mark>. Then add the Cook’s D variable COO_1 to the <mark>Y Axis:</mark> box and the id variable to the <mark>X Axis:</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>There are no clear outliers, i.e.&nbsp;observations that are much more influential on the results than most observations.</p>
</section>
<section id="step-5-understand-the-results-tables-and-extract-the-key-results" class="level3">
<h3 class="anchored" data-anchor-id="step-5-understand-the-results-tables-and-extract-the-key-results">Step 5: understand the results tables and extract the key results</h3>
<p>So now that we have verified that the assumptions of the model are not clearly violated, we can finally interpret our results.</p>
<p>The “Between-Subjects Factors” just shows us the sample size per group for our covariate and we we will again ignore the “Tests of Between-Subjects Effects” and focus just on the final table called “Parameter Estimates”. See the first exercise for the previous linear regression practical for more information on what this table contains.</p>
<p>First we will consider the point estimates for the various coefficients. The name/categorical level is given in the first column called “Parameter” and the point estimates of the coefficients are given in the second column called “B”.</p>
<p>Remember that the intercept is the expected mean of the outcome when all covariates = 0. We just have one categorical covariate, and each category group will be represented within the model via separate dummy coded binary (0/1) variables. Therefore, the intercept represents the expected mean of the outcome when the sex_smoke variable = 0. We can work out which level has been coded as 0 (or the reference) easily. Look at the very bottom of the table and it says “a. This parameter is set to zero because it is redundant.” We can then look for the covariate in the “B” column that is 0 and has a superscript “a” next to it. Under the “Parameter” column this is the covariate level m_yes (listed as “sex_smoke=m_yes”). Therefore, the intercept represents the expected mean of the outcome (i.e.&nbsp;systolic blood pressure in units of mmHg) for male smokers.</p>
<p>Note, for string-coded categorical variables, by default SPSS sets the reference category based on the names of the levels in reverse alphabetical order. So if you have levels called “a” and “b” then “b” would be the reference. As we just have the one categorical covariate, the other coefficients therefore represent the difference between the expected mean of the outcome for each group compared to the reference group, which again is set to m_yes, i.e.&nbsp;male smokers.</p>
<p>For example, we can see that male non-smokers have an expected mean systolic blood pressure that is -19.4 mmHg lower than the expected mean systolic blood pressure for male smokers (best point estimate), and the 95% confidence intervals tell us that the likely value for this mean difference in the target population is between -21.3 and -17.5 mmHg (and if we want to frame this in terms of a null-hypothesis significance test then we can see the two-sided p-value for the null hypothesis that the coefficient = 0 under the “Sig.” column, which is &lt;0.001).</p>
<p>Then if we want to explore comparisons to groups other than the reference group we can look below at the “Contrast Results (K Matrix)” table. Here the first colum refers to the contrast or comparison of interest in terms of levels. These are as per the “Parameter estimates” table, so level 1 = fm_no, level 2 = fm_yes, level 3 = m_no and level 4 = m_yes (the reference level for the “Parameter estimates” table). So we can see that the final comparison of level 3 to level 4 matches that seen in the “Parameter estimates” table for level 3 (m_no). As always, if you want to swap any comparisons to the other way around just flip the signs and swap the confidence intervals.</p>
<p><strong>Practical importance</strong></p>
<p>As always, when it comes to making practical interpretations we need to consider whether the size and direction of plausible associations would be important clinically or for public health considerations.</p>
</section>
</section>
<section id="exercise-2-to-explore-how-we-can-describe-continuous-by-categorical-interactions-we-will-describe-how-the-population-level-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-sex-femalemale-using-linear-regression.-note-you-could-equally-frame-this-question-as-looking-how-the-association-between-sex-and-systolic-blood-pressure-varies-by-age.-its-two-sides-of-the-same-coin." class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-to-explore-how-we-can-describe-continuous-by-categorical-interactions-we-will-describe-how-the-population-level-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-sex-femalemale-using-linear-regression.-note-you-could-equally-frame-this-question-as-looking-how-the-association-between-sex-and-systolic-blood-pressure-varies-by-age.-its-two-sides-of-the-same-coin.">Exercise 2: to explore how we can describe continuous by categorical interactions, we will describe how the population-level association between age (years) and systolic blood pressure (mmHg - our outcome) varies by sex (female/male) using linear regression. Note, you could equally frame this question as looking how the association between sex and systolic blood pressure varies by age. It’s “two sides of the same coin”.</h2>
<section id="step-1-explore-the-data-1" class="level3">
<h3 class="anchored" data-anchor-id="step-1-explore-the-data-1">Step 1: explore the data</h3>
<section id="univariate" class="level4">
<h4 class="anchored" data-anchor-id="univariate">Univariate</h4>
<p>First, let’s explore the distribution of the outcome via a histogram.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Histograms</mark>. Add sbp_age_sex into the <mark>Variable:</mark> box, tick the <mark>Display normal curve</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>The overall distribution appears to be approximately normal but potentially there is some multi-modality, i.e.&nbsp;more than one peak/mean.</p>
<p>Next, let’s explore the distribution of age via a histogram.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Histograms</mark>. Add age into the <mark>Variable:</mark> box, tick the <mark>Display normal curve</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>It’s hard to interpret but age appears more uniformly distributed, or maybe a complex mix of a few peaks. Remember that linear regression can model continuous/discrete covariates of any distribution. It’s the distribution of the model residuals that must be approximately normal. It’s always good if the same size is reasonably equally distributed across the range of any continuous/discrete covariates, as this gives the model more information to estimate the association more accurately.</p>
<p>We’ve already explored the distribution of the sex variable, so need to do so again.</p>
</section>
<section id="bivariate" class="level4">
<h4 class="anchored" data-anchor-id="bivariate">Bivariate</h4>
<p>Let’s look visualise the distribution of systolic blood pressure values by age and sex.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Scatter/Dot</mark>. Then ensure <mark>Simple Scatter is selected</mark> and click <mark>OK</mark>. Then add the sbp_age_sex variable into the <mark>Y Axis:</mark> box, the age variable into the <mark>X Axis:</mark> box, and add the sex variable into the <mark>Set Markers By:</mark> box (which will colour points by sex), and then click <mark>OK</mark>.</li>
</ul>
<p>It looks like there is a linear association between age and systolic blood pressure for both sexes, but the association is steeper for men.</p>
</section>
</section>
<section id="step-2-run-the-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="step-2-run-the-regression-model">Step 2: run the regression model</h3>
<p>Sorry there are no video-based instructions.</p>
<p><strong>Written instructions: run the linear regression model</strong></p>
<details>
<summary>
Read/hide
</summary>
<ul>
<li><p>From the main menu go: <mark>Analyze &gt; General Linear Model &gt; Univariate</mark>.</p></li>
<li><p>Next, in the <mark>Univariate</mark> tool we add our outcome variable sbp_age_sex to the <mark>Dependent Variable:</mark> box. Then this time we add our covariate of age to the <mark>Covariate(s):</mark> box and our covariate of sex to the <mark>Fixed factors:</mark> box.</p></li>
<li><p>Next, click the <mark>Model</mark> button and in the <mark>Specify Model</mark> area click the <mark>Build terms:</mark> button. Then in the <mark>Build Term(s):</mark> area under <mark>Type:</mark> click on the drop-down menu and choose <mark>Main effects</mark>. Then click on sex and drag it into the <mark>Model:</mark> area on the right and release the click (or you can also click the blue, right-pointing arrow below the drop-down menu to add them). Repeat for the sex covariate. Both covariates should now be in the <mark>Model:</mark> area. Now click on the same drop-down menu again and choose <mark>Interaction</mark>. Then click on sex, hold shift, then click on age (so they are both highlighted) and, while still holding the left-button on the mouse down, drag them both into the <mark>Model:</mark> area and release. Under the age and sex covariates you should now see the interaction term “age*sex”. Now click <mark>Continue</mark> at the bottom of the tool.</p></li>
<li><p>Next, click the <mark>Save</mark> button and under <mark>Predicted Values</mark> tick the <mark>Unstandardized</mark> box, and then under <mark>Residuals</mark> tick the <mark>Unstandardized</mark> box, and then under <mark>Diagnostics</mark> tick the box for <mark>Cook’s distance</mark>.</p></li>
<li><p>Lastly, click the <mark>Options</mark> button, and then under <mark>Display</mark> tick the <mark>Parameter estimates</mark> box and click <mark>Continue</mark> and then <mark>OK</mark>. The output window will then pop up with the results, but first…</p></li>
</ul>
</details>
</section>
<section id="step-3-check-the-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="step-3-check-the-assumptions">Step 3: check the assumptions</h3>
<p>We would again need to verify all the assumptions. We only provide details where things are slightly different from the last exercise.</p>
<p><strong>1. Continuous outcome</strong> <strong>2. Independent observations</strong> <strong>3. Normally distributed residuals</strong> <strong>4. Linearity of the associations between the residuals and the numerical variable(s)</strong></p>
<p>As we now have a continuous/discrete covariate we would need to plot the residuals against the age covariate to check there are no trends. We can do this using a scatter plot.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Scatter/Dot</mark>, then select <mark>Simple Scatter</mark> and click <mark>Define</mark>. Add the RES_X variable into the <mark>Y Axis:</mark> box and the age variable into the <mark>X Axis:</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>There are no clear trends.</p>
<p><strong>5. Homoscedasticity: constant variance of the residuals across model predicted values</strong></p>
</section>
<section id="step-4-consider-additional-possible-issues" class="level3">
<h3 class="anchored" data-anchor-id="step-4-consider-additional-possible-issues">Step 4: consider additional possible issues</h3>
<p><strong>No extremely influential observations</strong></p>
<p>These can be checked as before, but there are again no concerns.</p>
</section>
<section id="step-5-understand-the-results-tables-and-extract-the-key-results-1" class="level3">
<h3 class="anchored" data-anchor-id="step-5-understand-the-results-tables-and-extract-the-key-results-1">Step 5: understand the results tables and extract the key results</h3>
<p>Again, we will focus on the “Parameter estimates” table. For our categorical covariate of sex we can see that the male level has been set as the reference level. Again, we can determine this by looking for which level = 0 and has the superscript “a” next to it, which links to the statement “The parameter is set to zero because it is redundant” at the bottom of the table.</p>
<p>Therefore, the intercept now has no real-world meaning because it represents the expected mean outcome when all covariates are 0, which here is for males aged 0. We could “centre” age so it is the difference from the mean of age and then the intercept would represent the expected mean outcome for males at the mean age (across all participants), but we are interested in the association between age and systolic blood pressure and how it varies by sex, so there is no benefit.</p>
<p>As we included an interaction between age and sex in the model the coefficient for age represents the slope (or more precisely the expected change in the mean of the outcome for every 1-unit increase in the covariate, i.e.&nbsp;for every year older) when sex = 0, which here represents males. We can therefore see that the model predicts that for every year older a male is their mean systolic blood pressure is expected to increase by 0.51 mmHg. The coefficient named “[sex=fm]*age” can then be interpreted as the model-predicted difference in the association (slope) between age and systolic blood pressure in females compared to the corresponding association (slope) in men. We can therefore see that the association (slope) between age and systolic blood pressure in females is 0.29 mmHg lower (because the coefficient is negative - the best point estimate) than the corresponding association (slope) in males, and the likely value for this difference in the target population is between -0.34 and -0.24 (with the p-value for the null-hypothesis that this difference in slopes = 0 given in the “Sig.” column).</p>
<p>Another way to understand this is that the model predicts that the association (slope) between age and systolic blood pressure in males is 0.51 while in females it is 0.51 + (-0.29) = 0.22, i.e.&nbsp;very roughly half as steep. If we wanted to get the predicted association (slope) for females and its 95% confidence intervals we could just recode the sex variable so that the female level was set to the reference level and re-run the model. Again, SPSS chooses the level where the name of that level starts/is made of letters that are lower in the alphabet. So you could e.g.&nbsp;recode it as “z_female” to ensure that female becomes the reference level. Then the age coefficient would represent the association (slope) for females.</p>
<p><strong>Practical importance</strong></p>
<p>As always, when it comes to making practical interpretations we need to consider whether the size and direction of plausible associations would be important clinically or for public health considerations.</p>
</section>
</section>
<section id="exercise-3-to-explore-how-we-can-describe-continuous-by-continuous-interactions-we-will-describe-how-the-population-level-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-bmi-kgm2-or-equivalently-how-how-the-population-level-association-between-bmi-kgm2-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-age-years-using-linear-regression.-again-this-is-two-sides-of-the-same-coin." class="level2">
<h2 class="anchored" data-anchor-id="exercise-3-to-explore-how-we-can-describe-continuous-by-continuous-interactions-we-will-describe-how-the-population-level-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-bmi-kgm2-or-equivalently-how-how-the-population-level-association-between-bmi-kgm2-and-systolic-blood-pressure-mmhg---our-outcome-varies-by-age-years-using-linear-regression.-again-this-is-two-sides-of-the-same-coin.">Exercise 3: to explore how we can describe continuous by continuous interactions, we will describe how the population-level association between age (years) and systolic blood pressure (mmHg - our outcome) varies by BMI (kg/m2), or equivalently how how the population-level association between BMI (kg/m2) and systolic blood pressure (mmHg - our outcome) varies by age (years), using linear regression. Again, this is “two sides of the same coin”.</h2>
<section id="step-1-explore-the-data-2" class="level3">
<h3 class="anchored" data-anchor-id="step-1-explore-the-data-2">Step 1: explore the data</h3>
<section id="univariate-1" class="level4">
<h4 class="anchored" data-anchor-id="univariate-1">Univariate</h4>
<p>First, let’s explore the distribution of the outcome via a histogram.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Histograms</mark>. Add sbp_age_bmi into the <mark>Variable:</mark> box, tick the <mark>Display normal curve</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>The overall distribution appears to be approximately normal but with a little right-skew.</p>
<p>Next, let’s explore the distribution of age and BMI via a histogram.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Histograms</mark>. Add bmi into the <mark>Variable:</mark> box, tick the <mark>Display normal curve</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>BMI appears fairly uniformly distributed.</p>
<p>We’ve already explored the distribution of the age variable, so need to do so again.</p>
</section>
<section id="bivariate-1" class="level4">
<h4 class="anchored" data-anchor-id="bivariate-1">Bivariate</h4>
<p>Let’s look visualise the distribution of systolic blood pressure values by BMI. We’ve already explored the distribution of systolic blood pressure by age, so need to do so again.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Scatter/Dot</mark>. Then ensure <mark>Simple Scatter is selected</mark> and click <mark>OK</mark>. Then add the sbp_age_bmi variable into the <mark>Y Axis:</mark> box, the bmi variable into the <mark>X Axis:</mark> box and then click <mark>OK</mark>.</li>
</ul>
<p>It looks like there is a linear association between BMI and systolic blood pressure.</p>
</section>
</section>
<section id="step-2-run-the-regression-model-1" class="level3">
<h3 class="anchored" data-anchor-id="step-2-run-the-regression-model-1">Step 2: run the regression model</h3>
<p>Sorry there are no video-based instructions.</p>
<p><strong>Written instructions: run the linear regression model</strong></p>
<details>
<summary>
Read/hide
</summary>
<ul>
<li><p>From the main menu go: <mark>Analyze &gt; General Linear Model &gt; Univariate</mark>.</p></li>
<li><p>Next, in the <mark>Univariate</mark> tool we add our outcome variable sbp_age_bmi to the <mark>Dependent Variable:</mark> box. Then this time we add our covariates of age and bmi to the <mark>Covariate(s):</mark> box.</p></li>
<li><p>Next, click the <mark>Model</mark> button and in the <mark>Specify Model</mark> area click the <mark>Build terms:</mark> button. Then in the <mark>Build Term(s):</mark> area under <mark>Type:</mark> click on the drop-down menu and choose <mark>Main effects</mark>. Then click on age and drag it into the <mark>Model:</mark> area on the right and release the click (or you can also click the blue, right-pointing arrow below the drop-down menu to add them). Repeat for the bmi covariate. Both covariates should now be in the <mark>Model:</mark> area. Now click on the same drop-down menu again and choose <mark>Interaction</mark>. Then click on age, hold shift, then click on bmi (so they are both highlighted) and, while still holding the left-button on the mouse down, drag them both into the <mark>Model:</mark> area and release. Under the age and bmi covariates you should now see the interaction term “age*bmi”. Now click <mark>Continue</mark> at the bottom of the tool.</p></li>
<li><p>Next, click the <mark>Save</mark> button and under <mark>Predicted Values</mark> tick the <mark>Unstandardized</mark> box, and then under <mark>Residuals</mark> tick the <mark>Unstandardized</mark> box, and then under <mark>Diagnostics</mark> tick the box for <mark>Cook’s distance</mark>.</p></li>
<li><p>Lastly, click the <mark>Options</mark> button, and then under <mark>Display</mark> tick the <mark>Parameter estimates</mark> box and click <mark>Continue</mark> and then <mark>OK</mark>. The output window will then pop up with the results, but first…</p></li>
</ul>
</details>
</section>
<section id="step-3-check-the-assumptions-1" class="level3">
<h3 class="anchored" data-anchor-id="step-3-check-the-assumptions-1">Step 3: check the assumptions</h3>
<p>We would again need to verify all the assumptions. We only provide details where things are slightly different from the last exercise.</p>
<p><strong>1. Continuous outcome</strong> <strong>2. Independent observations</strong> <strong>3. Normally distributed residuals</strong> <strong>4. Linearity of the associations between the residuals and the numerical variable(s)</strong></p>
<p>As we now have two continuous/discrete covariate we would need to plot the residuals against both to check there are no trends. We can do this using a scatter plot.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Scatter/Dot</mark>, then select <mark>Simple Scatter</mark> and click <mark>Define</mark>. Add the RES_X variable into the <mark>Y Axis:</mark> box and the age variable into the <mark>X Axis:</mark> box and click <mark>OK</mark>. Repeat for bmi.</li>
</ul>
<p>There are no clear trends.</p>
<p><strong>5. Homoscedasticity: constant variance of the residuals across model predicted values</strong></p>
</section>
<section id="step-4-consider-additional-possible-issues-1" class="level3">
<h3 class="anchored" data-anchor-id="step-4-consider-additional-possible-issues-1">Step 4: consider additional possible issues</h3>
<p><strong>No extremely influential observations</strong></p>
<p>These can be checked as before, but there are again no concerns.</p>
</section>
<section id="step-5-understand-the-results-tables-and-extract-the-key-results-2" class="level3">
<h3 class="anchored" data-anchor-id="step-5-understand-the-results-tables-and-extract-the-key-results-2">Step 5: understand the results tables and extract the key results</h3>
<p>Again, we will focus on the “Parameter estimates” table. The intercept now represents the expected mean of the outcome when both age and BMI = 0, so clearly it has no real-world interpretation (but again, we could centre both covariates and then it would be interpretable).</p>
<p>The bmi and age coefficients then represent the model-predicted association (slope) between BMI and systolic blood pressure when age = 0 and between age and systolic blood pressure when BMI = 0, so similarly they are not very meaningful.</p>
<p>The “bmi * age” coefficient represents either the difference in the association (slope) between BMI and systolic blood pressure for a 1-unit increase in age, or equivalently the difference in the association (slope) between age and systolic blood pressure for a 1-unit increase in BMI. Therefore, we can see that the association (slope) between age and systolic blood pressure increases (becomes more steeply positive) for every 1-unit increase in BMI by 0.031 mmHg (best point estimate), with the likely value for the increase in the target population is between 0.027 and 0.035, and equivalently the association (slope) between BMI and systolic blood pressure increases (becomes more steeply positive) for every 1-unit increase in age by 0.031 mmHg (best point estimate), with the likely value for the increase in the target population is between 0.027 and 0.035.</p>
<p>It is usually most helpful to interpret one or both associations at key values of the other covariate. For example, the association (slope) between age and systolic blood pressure at key values of BMI. This can be done by using the model to predict expected mean values of the outcome (and confidence intervals for those values) for representative values of age and key values of BMI (or vice versa). However, in SPSS this is quite tricky and time consuming, so we won’t look at this further in this session.</p>
<p><strong>Practical importance</strong></p>
<p>As always, when it comes to making practical interpretations we need to consider whether the size and direction of plausible associations would be important clinically or for public health considerations.</p>
</section>
</section>
<section id="exercise-4-to-explore-how-we-can-describe-non-linear-associations-between-continuousdiscrete-covariates-and-continuous-outcomes-we-will-describe-the-population-level-non-linear-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome." class="level2">
<h2 class="anchored" data-anchor-id="exercise-4-to-explore-how-we-can-describe-non-linear-associations-between-continuousdiscrete-covariates-and-continuous-outcomes-we-will-describe-the-population-level-non-linear-association-between-age-years-and-systolic-blood-pressure-mmhg---our-outcome.">Exercise 4: to explore how we can describe non-linear associations between continuous/discrete covariates and continuous outcomes, we will describe the population-level non-linear association between age (years) and systolic blood pressure (mmHg - our outcome).</h2>
<section id="step-1-explore-the-data-3" class="level3">
<h3 class="anchored" data-anchor-id="step-1-explore-the-data-3">Step 1: explore the data</h3>
<section id="univariate-2" class="level4">
<h4 class="anchored" data-anchor-id="univariate-2">Univariate</h4>
<p>First, let’s explore the distribution of the outcome via a histogram.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Histograms</mark>. Add sbp_age2 into the <mark>Variable:</mark> box, tick the <mark>Display normal curve</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>The overall distribution appears to be approximately normal.</p>
<p>We’ve already explored the distribution of age previously, which is approximately uniform.</p>
</section>
<section id="bivariate-2" class="level4">
<h4 class="anchored" data-anchor-id="bivariate-2">Bivariate</h4>
<p>Let’s look visualise the distribution of systolic blood pressure values by age, which will now be non-linear by design for this practical.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Scatter/Dot</mark>. Then ensure <mark>Simple Scatter is selected</mark> and click <mark>OK</mark>. Then add the sbp_age2 variable into the <mark>Y Axis:</mark> box, the age variable into the <mark>X Axis:</mark> box and then click <mark>OK</mark>.</li>
</ul>
<p>It’s hard to see but there is a hint of a slight inverted-u shape to the trend in the points.</p>
</section>
</section>
<section id="step-2-run-the-regression-model-2" class="level3">
<h3 class="anchored" data-anchor-id="step-2-run-the-regression-model-2">Step 2: run the regression model</h3>
<p>Sorry there are no video-based instructions.</p>
<p><strong>Written instructions: run the linear regression model</strong></p>
<details>
<summary>
Read/hide
</summary>
<ul>
<li>First we need to create our age squared variable. From the main menu go: <mark>Transform &gt; Compute Variable</mark>. Then in the <mark>Target Variable:</mark> box add a name for our age squared variable. I will use age2. Then in the <mark>Numeric Expression:</mark> box add <mark>age ** 2</mark>. The “**” indicates you are raising the variable age to a power, in this case 2, i.e.&nbsp;squaring it. Then click <mark>OK</mark>.</li>
</ul>
<p>Now we can run the model.</p>
<ul>
<li><p>From the main menu go: <mark>Analyze &gt; General Linear Model &gt; Univariate</mark>.</p></li>
<li><p>Next, in the <mark>Univariate</mark> tool we add our outcome variable sbp_age2 to the <mark>Dependent Variable:</mark> box. Then this time we add our covariates of age and age2 to the <mark>Covariate(s):</mark> box.</p></li>
<li><p>Next, click the <mark>Model</mark> button and in the <mark>Specify Model</mark> area click the <mark>Build terms:</mark> button. Then in the <mark>Build Term(s):</mark> area under <mark>Type:</mark> click on the drop-down menu and choose <mark>Main effects</mark>. Then click on age and drag it into the <mark>Model:</mark> area on the right and release the click (or you can also click the blue, right-pointing arrow below the drop-down menu to add them). Repeat for the age2 covariate.</p></li>
<li><p>Next, click the <mark>Save</mark> button and under <mark>Predicted Values</mark> tick the <mark>Unstandardized</mark> and <mark>Standard Error</mark> boxes, and then under <mark>Residuals</mark> tick the <mark>Unstandardized</mark> box, and then under <mark>Diagnostics</mark> tick the box for <mark>Cook’s distance</mark>.</p></li>
<li><p>Lastly, click the <mark>Options</mark> button, and then under <mark>Display</mark> tick the <mark>Parameter estimates</mark> box and click <mark>Continue</mark> and then <mark>OK</mark>. The output window will then pop up with the results, but first…</p></li>
</ul>
</details>
</section>
<section id="step-3-check-the-assumptions-2" class="level3">
<h3 class="anchored" data-anchor-id="step-3-check-the-assumptions-2">Step 3: check the assumptions</h3>
<p>We would again need to verify all the assumptions. We only provide details where things are slightly different from the last exercise.</p>
<p><strong>1. Continuous outcome</strong> <strong>2. Independent observations</strong> <strong>3. Normally distributed residuals</strong> <strong>4. Linearity of the associations between the residuals and the numerical variable(s)</strong></p>
<p>Note: if there is a non-linear trend in the association between age and systolic blood pressure if our model adequately models this via our quadratic term then the residuals should show no trends as they should be approximately evenly distributed around the model-predicted mean, which itself will have a non-linear association with age. Let’s check.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Scatter/Dot</mark>, then select <mark>Simple Scatter</mark> and click <mark>Define</mark>. Add the RES_X variable into the <mark>Y Axis:</mark> box and the age variable into the <mark>X Axis:</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>There are no clear trends.</p>
<p><strong>5. Homoscedasticity: constant variance of the residuals across model predicted values</strong></p>
</section>
<section id="step-4-consider-additional-possible-issues-2" class="level3">
<h3 class="anchored" data-anchor-id="step-4-consider-additional-possible-issues-2">Step 4: consider additional possible issues</h3>
<p><strong>No extremely influential observations</strong></p>
<p>These can be checked as before, but there are again no concerns.</p>
</section>
<section id="step-5-understand-the-results-tables-and-extract-the-key-results-3" class="level3">
<h3 class="anchored" data-anchor-id="step-5-understand-the-results-tables-and-extract-the-key-results-3">Step 5: understand the results tables and extract the key results</h3>
<p>Again, we will focus on the “Parameter estimates” table. The intercept now represents the expected mean of the outcome when both age and age2 are 0, so clearly it has no real-world interpretation (but again, we could centre both covariates and then it would be interpretable ).</p>
<p>We cannot usefully interpret the coefficient for age because it depends on age2, i.e.&nbsp;the association is non-linear and cannot be described by a single slope value. Therefore, typically we would compute predicted values for a range of values of our covariate using the model (along with and their confidence intervals) and plot those to visualise the non-linear association and allow inference for practical interpretation.</p>
<p>It is again not straight forward to do this in SPSS, but it’s not too complicated to at least plot the predict outcome values from the model against the observed covariate values, so let’s do that.</p>
<ul>
<li>From the main menu go: <mark>Graphs &gt; Scatter/Dot</mark>, then select <mark>Simple Scatter</mark> and click <mark>Define</mark>. Add the PRE_X variable into the <mark>Y Axis:</mark> box (where _X may be 4 if you’ve just made one model per exercise but it may be higher - used the highest value as that will be the most recent predicted values variable) and the age variable into the <mark>X Axis:</mark> box and click <mark>OK</mark>.</li>
</ul>
<p>Remember to pay attention to the axes. Without further editing these are the defaults, and a restricted y-axis range will make any curve appear more curved than a more honest perspective when looking across a wider range of possible outcome values.</p>
<p><strong>Practical importance</strong></p>
<p>As always, when it comes to making practical interpretations we need to consider whether the size and direction of plausible associations would be important clinically or for public health considerations.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>