<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>probability-sampling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-beb392ddb238527d957dbf35687def22.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./probability-sampling.html">1. Probability sampling</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./website-information.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to use this website</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability-sampling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">1. Probability sampling</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">2. Introducing SPSS &amp; preparing data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction-to-spss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.1. Introducing SPSS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preparing-a-dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.2. Preparing a dataset</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sample-description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Data exploration &amp; sample description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./population-description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Population description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sample-size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Sample size calculations</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">6. Bivariate tests for numerical variables</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./independent-t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.1. Independent t-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./independent-t-test-skewed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.2. Independent t-test with skewed data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./paired-t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.3. Paired t-test</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">7. Bivariate tests for categorical variables</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi-sq-independence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.1. Chi-square test of independence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi-sq-goodness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.2. Chi-square goodness of fit test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./paired-categorical-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.3. Paired categorical variable test (McNemar’s test)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">8. Regresson modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.1. Linear regression I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression-further.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.2. Linear regression II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.3. Logistic regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complex-sampling-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Complex sampling design analysis</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#probability-sampling" id="toc-probability-sampling" class="nav-link active" data-scroll-target="#probability-sampling">Probability sampling</a></li>
  <li><a href="#rationale-and-theory" id="toc-rationale-and-theory" class="nav-link" data-scroll-target="#rationale-and-theory">Rationale and theory</a>
  <ul class="collapse">
  <li><a href="#key-terminology-units-of-observation-and-analysis" id="toc-key-terminology-units-of-observation-and-analysis" class="nav-link" data-scroll-target="#key-terminology-units-of-observation-and-analysis">Key terminology: units of observation and analysis</a></li>
  <li><a href="#overview-of-key-concepts" id="toc-overview-of-key-concepts" class="nav-link" data-scroll-target="#overview-of-key-concepts">Overview of key concepts</a></li>
  </ul></li>
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice">Practice</a>
  <ul class="collapse">
  <li><a href="#exercise-1-simple-random-sampling" id="toc-exercise-1-simple-random-sampling" class="nav-link" data-scroll-target="#exercise-1-simple-random-sampling">Exercise 1: Simple random sampling</a>
  <ul class="collapse">
  <li><a href="#a-brief-overview-of-the-method" id="toc-a-brief-overview-of-the-method" class="nav-link" data-scroll-target="#a-brief-overview-of-the-method">A brief overview of the method</a></li>
  <li><a href="#advantages-and-disadvantages" id="toc-advantages-and-disadvantages" class="nav-link" data-scroll-target="#advantages-and-disadvantages">Advantages and disadvantages</a></li>
  <li><a href="#scenario" id="toc-scenario" class="nav-link" data-scroll-target="#scenario">Scenario</a></li>
  <li><a href="#exercise-taking-a-simple-random-sample-using-excel" id="toc-exercise-taking-a-simple-random-sample-using-excel" class="nav-link" data-scroll-target="#exercise-taking-a-simple-random-sample-using-excel">Exercise: taking a simple random sample using Excel</a></li>
  </ul></li>
  <li><a href="#exercise-2-stratified-random-sampling" id="toc-exercise-2-stratified-random-sampling" class="nav-link" data-scroll-target="#exercise-2-stratified-random-sampling">Exercise 2: Stratified random sampling</a>
  <ul class="collapse">
  <li><a href="#a-brief-overview-of-the-method-1" id="toc-a-brief-overview-of-the-method-1" class="nav-link" data-scroll-target="#a-brief-overview-of-the-method-1">A brief overview of the method</a></li>
  <li><a href="#advantages-and-disadvantages-1" id="toc-advantages-and-disadvantages-1" class="nav-link" data-scroll-target="#advantages-and-disadvantages-1">Advantages and disadvantages</a></li>
  <li><a href="#scenario-1" id="toc-scenario-1" class="nav-link" data-scroll-target="#scenario-1">Scenario</a></li>
  <li><a href="#exercise-taking-a-proportionate-stratified-random-sample-using-excel" id="toc-exercise-taking-a-proportionate-stratified-random-sample-using-excel" class="nav-link" data-scroll-target="#exercise-taking-a-proportionate-stratified-random-sample-using-excel">Exercise: taking a proportionate stratified random sample using Excel</a></li>
  </ul></li>
  <li><a href="#exercise-3-systematic-random-sampling" id="toc-exercise-3-systematic-random-sampling" class="nav-link" data-scroll-target="#exercise-3-systematic-random-sampling">Exercise 3: Systematic random sampling</a>
  <ul class="collapse">
  <li><a href="#a-brief-overview-of-the-method-2" id="toc-a-brief-overview-of-the-method-2" class="nav-link" data-scroll-target="#a-brief-overview-of-the-method-2">A brief overview of the method</a></li>
  <li><a href="#advantages-and-disadvantages-2" id="toc-advantages-and-disadvantages-2" class="nav-link" data-scroll-target="#advantages-and-disadvantages-2">Advantages and disadvantages</a></li>
  <li><a href="#scenario-2" id="toc-scenario-2" class="nav-link" data-scroll-target="#scenario-2">Scenario</a></li>
  <li><a href="#exercise-taking-a-systematic-random-sample-using-excel" id="toc-exercise-taking-a-systematic-random-sample-using-excel" class="nav-link" data-scroll-target="#exercise-taking-a-systematic-random-sample-using-excel">Exercise: taking a systematic random sample using Excel</a></li>
  </ul></li>
  <li><a href="#single-stage-cluster-sampling-and-multi-stage-cluster-sampling" id="toc-single-stage-cluster-sampling-and-multi-stage-cluster-sampling" class="nav-link" data-scroll-target="#single-stage-cluster-sampling-and-multi-stage-cluster-sampling">Single-stage cluster sampling and multi-stage cluster sampling</a>
  <ul class="collapse">
  <li><a href="#cluster-random-sampling" id="toc-cluster-random-sampling" class="nav-link" data-scroll-target="#cluster-random-sampling">Cluster random sampling</a></li>
  <li><a href="#multi-stage-clustered-random-sample" id="toc-multi-stage-clustered-random-sample" class="nav-link" data-scroll-target="#multi-stage-clustered-random-sample">Multi-stage clustered random sample</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="probability-sampling" class="level1">
<h1>Probability sampling</h1>
<hr>
<p>In this practical we will practice carrying out three common probability sampling methods using Excel.</p>
<p><br></p>
</section>
<section id="rationale-and-theory" class="level1">
<h1>Rationale and theory</h1>
<hr>
<p>If you are confident on the theory and approaches to probability sampling then you can skip on to the exercises below. However, if you are not fully confident about these topics we strongly suggest reading the below information.</p>
<section id="key-terminology-units-of-observation-and-analysis" class="level2">
<h2 class="anchored" data-anchor-id="key-terminology-units-of-observation-and-analysis">Key terminology: units of observation and analysis</h2>
<details>
<summary>
Read/hide
</summary>
<ul>
<li><p>Sampling unit: these are the entities or things that you sample for the study. These will often be individuals but could be anything, such as households or health facilities. The sampling unit should be fully defined in the description of the study’s sampling methods.</p></li>
<li><p>Unit of observation (also called study units or study subjects): these are the entities or things that you collect data from. Again, these will often be individuals but could be anything, such as households or health facilities. Note that you might sample “higher level” units, such as entire households, but collect data from “lower level” units, such as individuals within those households. The unit of observation should be fully defined by the study’s eligibility criteria.</p></li>
<li><p>Unit of analysis: the entity or thing that you analysing in your study and thereby strictly aim to make statistical inferences about using the data collected. This will often be the same as the unit of observation, but it may differ depending on how you are analysing the data. For example, the unit of observation may be individuals, but the unit of analysis may be the household if you aggregate individual outcomes within each household (e.g.&nbsp;as a single mean or percentage value per household).</p></li>
</ul>
</details>
</section>
<section id="overview-of-key-concepts" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-key-concepts">Overview of key concepts</h2>
<details>
<summary>
Read/hide
</summary>
<p><strong>Probability sampling</strong></p>
<p>Broadly speaking, sampling is the process whereby we choose units of observation within our target population to collect data from. <em>Therefore, the first stage of sampling, which should always occur very early on in the research and study design process, is when you clearly and explicitly define your target population.</em> In summary, the only sampling methods that are guaranteed to produce unbiased statistical inferences, albeit only on average (or to use the more technical term “in expectation”, meaning in the long-run), are “probability sampling” methods. More loosely these are sometimes referred to as random sampling methods. This is because all frequentist statistical methods of analysis assume that the sample data have been randomly sampled from a given target population using some specific probability sampling method. Therefore, the only way to robustly satisfy this assumption is clearly to use some form of probability sampling method.</p>
<p>To take a probability sample you require a sampling frame, which is a list of all units of observation in the target population that you are aiming to generalise your results to (e.g.&nbsp;all individuals in a region, all primary care health facilities in a country etc). <em>Therefore, the second stage of any sampling process is to obtain or create a sampling frame for your target population</em>. Note: this excludes multi-stage cluster sampling methods, where you require a sampling frame for the first stage clusters, but at the second/subsequent stages you usually create the sampling frame via a mapping process, as none usually exist.</p>
<p>Note: for a probability sampling method to be valid it must be possible to calculate each unit of observation’s probability of being selected, which may or may not be equal for all units, and should not be zero for any unit. For example, if the target population contained 100 individuals and we randomly select 10 individuals via simple random sampling then the probability of being sampled would be 10/100 = 0.1 for each individual.</p>
<p><strong>Non-probability sampling</strong></p>
<p>While desirable it is clearly often not feasible to use probability sampling methods, usually because of the lack of a suitable sampling frame. For example, if you are studying patients attending a healthcare facility over a given period and you need to collect data on sampled patients <em>on the day they attend the facility</em> it’s typically impossible to construct a sampling frame because you won’t know who will be visiting each day! Therefore, you may often need to resort to non-probability sampling methods such as consecutive sampling, while minimising the opportunity for any researcher sampling bias, and hope that your samples are representative of your target population.</p>
</details>
<p><br></p>
</section>
</section>
<section id="practice" class="level1">
<h1>Practice</h1>
<hr>
<section id="exercise-1-simple-random-sampling" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-simple-random-sampling">Exercise 1: Simple random sampling</h2>
<section id="a-brief-overview-of-the-method" class="level3">
<h3 class="anchored" data-anchor-id="a-brief-overview-of-the-method">A brief overview of the method</h3>
<p>Simple random sampling involves taking a random sample of a given size from a sampling frame, which results in each unit of observation having an equal probability of being selected. You can take a simple random sample from a sampling frame in various ways, such as by generating random numbers that correspond to IDs that are pre-allocated to all units of observation, or you can do it by simply randomly sorting the list and just selecting the first n units of observation, where n is your sample size. We will use this second approach as it’s easy to implement in Excel.</p>
</section>
<section id="advantages-and-disadvantages" class="level3">
<h3 class="anchored" data-anchor-id="advantages-and-disadvantages">Advantages and disadvantages</h3>
<details>
<summary>
Read/hide
</summary>
<p><br></p>
<p><strong>Advantages</strong></p>
<ul>
<li><p>Easy to implement and explain.</p></li>
<li><p>Requires minimal data on your target population units of observation: just a list of all units of observation, plus usually some way of identifying/contacting them once selected.</p></li>
<li><p>Statistically efficient: you maximise the precision/power of your inferential analyses when you use simple random sampling.</p></li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li><p>Although simple random sampling guarantees that you will select a sample that is representative (i.e.&nbsp;unbiased) of your target population <em>on average/in the long-run</em>, i.e.&nbsp;over many hypothetically repeated samples, it is not the best approach at achieving this goal for any given sample, and obviously in practice you typically only ever take one sample! This is especially the case when the population is heterogeneous (highly varied in the characteristics/relationships of interest) and/or if sample size is small, say in the tens or low hundreds rather than the high hundreds or thousands (as the sample size increases the chances of getting an unrepresentative sample decrease). As these two situations are often true it is often better to use stratified random sampling instead, if possible. Other approaches to deal with this issue also exist but are beyond the scope of this module.</p></li>
<li><p>If your sampling units cover a large geographical area simple random sampling can produce a very logistically inefficient, costly, and geographically spread-out sample. See cluster sampling for an possible solution to this problem.</p></li>
</ul>
</details>
</section>
<section id="scenario" class="level3">
<h3 class="anchored" data-anchor-id="scenario">Scenario</h3>
<p>You work for a district governmental health department and you have been tasked with assessing the capacity and service delivery characteristics of the public primary care facilities across the whole district. Specifically, you need to report the typical staffing levels, resources and equipment levels, and services delivery levels for all public primary care facilities (e.g.&nbsp;the mean no. drs and nurses per facility.</p>
<p>However, while there are 246 such facilities within your district you only have resources to survey 50 facilities (if you could survey all 246 it would be a “census” not a sample). You run a sample size calculation that indicates a sample size of 50 will be sufficient to provide usefully precise, albeit fairly rough, estimates of these characteristics at the district level (note a sample size of 50 is typically going to be too small for a real study, but we are only practicing sampling here so it doesn’t matter). The target population to which you want to be able to generalise your results is therefore all 246 facilities.</p>
<p>Luckily there is an existing comprehensive list (i.e.&nbsp;sampling frame) of all 246 existing public primary care facilities in your district. You have a copy of this list, in the form of an Excel spreadsheet, that includes facility names, addresses and telephone numbers, plus additional information that we will use in subsequent exercises.</p>
<blockquote class="blockquote">
<p>Our aim is therefore to take a simple random sample of 50 facilities from the list.</p>
</blockquote>
</section>
<section id="exercise-taking-a-simple-random-sample-using-excel" class="level3">
<h3 class="anchored" data-anchor-id="exercise-taking-a-simple-random-sample-using-excel">Exercise: taking a simple random sample using Excel</h3>
<ul>
<li>Go into the “Datasets” folder that you should have moved to a suitable folder on your computer and load the “Health facilities list - simple random sample.xlsx” Excel spreadsheet. If you haven’t downloaded the datasets for the computer practical sessions and moved them to a suitable folder go to <a href="./datasets.html"><strong>Datasets</strong></a>.</li>
</ul>
<p><a href="https://youtu.be/GrHFm7VlNt4">Video instructions: taking a simple random sample using Excel</a></p>
<p><strong>Written instructions: taking a simple random sample using Excel</strong></p>
<details>
<summary>
Read/hide
</summary>
<ul>
<li><p>In the “Health facilities list - simple random sample.xlsx” Excel spreadsheet you will see it has various self-explanatory columns/variables including “facility_name”, “facility_address”, and “facility_tel”.</p></li>
<li><p>In column A (the blank column immediately to the left of the “facility_name” column) enter the following (or similar) word as a heading: random_no</p></li>
<li><p>Immediately under this new column in cell A2 (the first row where the facility data starts) click on the cell and type <mark>=rand()</mark> and press enter. This Excel function generates a random number between 0 and 1 to six decimal places.</p></li>
<li><p>Then simply ensure that cell A2 is selected (i.e.&nbsp;you’ve clicked on it) and then just double click on the small solid square at the very bottom right of this cell. This should copy and paste the function all the way down to the end of the facility data.</p></li>
<li><p>Next click on the “random_no” column heading (cell A1) and then in the menu “ribbon” click on <mark>Data</mark> and click the <mark>Filter</mark> tool. You should see little “drop-down” menu buttons appear in the right of each column heading. Click on the drop-down menu button in the “random_no” column heading (cell A1) and select <mark>Sort Smallest to Largest</mark>.</p></li>
<li><p>This will immediately sort all the data in order from those in the same row of the smallest random number value to the largest. Therefore, the list will now be randomly sorted! Note: the random numbers will all change immediately after sorting so they will actually no longer be ordered. This is because they are functions and will get re-calculated each time you change anything. However, this doesn’t matter because once all data have been sorted based on the original random numbers we don’t need those original values anymore.</p></li>
<li><p>Next, look at the bottom left of the window and you should see a tab titled <mark>Sheet1</mark>. This is the current worksheet. Click on the little + symbol to the right of this sheet to create a new worksheet. This will automatically be given the name “Sheet2”.</p></li>
<li><p>Now click back on the <mark>Sheet1</mark> worksheet. You can now simply copy the details of the first 50 facilities in the newly randomly sorted list and copy them into the <mark>Sheet2</mark> worksheet. This is now your simple random sample of health facilities. If this was a real study you could then use the contact information to recruit and plan your data collection.</p></li>
</ul>
</details>
<p><br></p>
</section>
</section>
<section id="exercise-2-stratified-random-sampling" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-stratified-random-sampling">Exercise 2: Stratified random sampling</h2>
<section id="a-brief-overview-of-the-method-1" class="level3">
<h3 class="anchored" data-anchor-id="a-brief-overview-of-the-method-1">A brief overview of the method</h3>
<p>In summary, stratified random sampling involves the following three main steps.</p>
<ol type="1">
<li><strong>Define your strata</strong>. Strata are simply a set of two or more mutually exclusive and comprehensive groups that cover all your sampling frame’s units of observation. This just means that every unit of observation in your sampling frame is a member of <em>one and only one stratum</em>. For example, if we were sampling individuals and had data on their ages we could stratify the them (i.e.&nbsp;the sampling frame) based on age, most simply by splitting all individuals into two age groups, say those aged &lt;18 and those aged 18 years or more. We will see below what to consider when selecting strata.</li>
</ol>
<p>Note: the singular of strata is stratum, e.g.&nbsp;“we create many strata but sample each stratum separately”. Note: you can define n strata for any single stratification variable, and your total strata will be the product of the number of strata created for each variable. For example, if you stratify based on age, grouped into &lt;18s and ≥18s, and sex, grouped into male or female, you have 2 x 2 = 4 strata in total. As you can see the total number of strata therefore increases rapidly with every extra stratification variable and/or group added! Note also: you cannot create a strata with no units of observation in. For example, if there were no &lt;18 men in your sampling frame you could not create an &lt;18-male strata group as the analysis would not work.</p>
<ol start="2" type="1">
<li><strong>Decide on the sample size for each strata</strong>. There are two different versions of stratified random sampling: one that uses “proportionate stratification” and one that uses “disproportionate stratification”.</li>
</ol>
<p>Proportionate stratification means that the sizes of your sample’s strata are proportional to the size of the strata in the target population. For example, using the example above of stratifying by age with two groups of &lt;18 and ≥18: if 25% of the target population were aged &lt;18 (and therefore 75% are aged ≥18) whatever your sample size was 25% of the sample size would come from your &lt;18 stratum and 75% from your ≥18 stratum. This would result in a representative distribution of ages in your sample and preserve the equal probability of selection for all units of observation in your sampling frame.</p>
<p>Disproportionate stratification is when the size of your sample’s strata is not proportional to their size in the target population. If this is the case then the units of observation in your sampling frame no longer have an equal probability of selection. This means you would have to calculate sampling weights to “map” the same back to the target population and avoid biased results when analysing the data.</p>
<ol start="3" type="1">
<li><strong>Take a simple random sample (or less commonly a systematic random sample) of the relevant size in each strata.</strong></li>
</ol>
<p>So we can use the same approach as we took above for the simple random sample and just repeat it within each strata the appropriate number of times.</p>
</section>
<section id="advantages-and-disadvantages-1" class="level3">
<h3 class="anchored" data-anchor-id="advantages-and-disadvantages-1">Advantages and disadvantages</h3>
<details>
<summary>
Read/hide
</summary>
<p><br></p>
<p><strong>Advantages</strong></p>
<p>The advantages and uses of stratified random sampling differ somewhat depending on whether you are using a proportionate or disproportionate stratification, and the reason for doing either depends on your goals and skills.</p>
<ol type="1">
<li>For studies aiming to describe the characteristics of a target population, where you have no particular interest in any specific sub-populations (compare to scenario 2 below), compared to using simple random sampling stratified random sampling with <em>proportionate stratification</em> can help you to: a) reduce the chances of obtaining an unrepresentative sample, at least in terms of the characteristics represented by your chosen strata, and b) increase the precision of your estimates for a given sample size. While for studies aiming to estimate relationships within a target population, where you have no particular interest in any specific sub-populations, compared to using simple random sampling stratified random sampling can similarly help you to increase the precision with which you can estimate your relationships of interest for a given sample size, giving you a more “statistically efficient” sample.</li>
</ol>
<ul>
<li><p>How well you achieve these goals depends on how well your chosen strata capture characteristics or variables that account for variation in your outcomes of interest. That is, you want units of observation to be as similar (homogeneous) as possible within strata and, on average, as dissimilar (heterogeneous) as possible between strata. For example, if we are interested in estimating rates of cardiovascular events then stratifying by age makes a lot of sense, because age is one of if not the biggest “causes” of cardiovascular events, i.e.&nbsp;the likelihood of having experienced a cardiovascular event will be quite similar for individuals within a young-age stratum and very different for those individuals compared to individuals in an geriatric-age stratum.</p></li>
<li><p>Note: using proportionate stratification is not actually necessary to achieve these goals, but it results in a sample that does not need reweighting during analysis to avoid unbiased results, and calculating weights is complicated, plus there is typically no good reason to use disproportionate stratification in this case (again see scenario 2 below).</p></li>
</ul>
<ol start="2" type="1">
<li>In other situations however you be particularly interested in specific sub-populations. In this case you can use stratification to “oversample” those sub-populations to ensure you have enough sample size to estimate characteristics/relationships for those sub-populations (strata) with sufficient precision/power. For example, you may wish to ensure you can estimate certain characteristics or relationships within a certain small, ethnic minority group with sufficient precision. With a simple random sample you would, on average, take a sample from the ethnic minority group that was proportional to its population size. For example, if the ethnic minority group were just 1% of the target population and you took a sample of 1000 individuals from the target population then on average you would only sample 10 individuals from the ethnic minority group! Hardly much use. Instead you could create strata for each ethnic group and take a fixed, larger (disproportionate) sample from the relevant ethnic minority group than you would take if you were using simple random sampling. This would be using disproportionate stratification.</li>
</ol>
<ul>
<li>However, as noted earlier if you do this the added complication is that the relative sizes for one or more strata will then, by design, not match their relative sizes in the target population. This means there is not an equal probability of selection for all sampling units, and you would have to calculate and use sampling weights to “map” the sample back onto the target population and avoid obtaining biased results. As this is a more complicated process and this type of stratified sampling is not commonly used (although a form of it is commonly used in multi-stage cluster sampling) we will not look at it further. Note: when using disproportionate stratification you would still be able to gain the advantages mentioned for scenario 1 above if your strata, either those that are disproportionately sampled or indeed other strata, capture important sources of variation within your outcomes of interest.</li>
</ul>
<p>In the following exercise we will just look at how to implement the first approach discussed above.</p>
<p><strong>Disadvantages of stratified random sampling with proportionate stratification</strong></p>
<ul>
<li><p>You require data on the characteristics needed to define your strata for all members of your target population, and it is often not possible or difficult and/or costly to obtain this data.</p></li>
<li><p>Compared to simple random sampling it is a somewhat more complicated and time consuming process (although this is typically a minor limitation).</p></li>
<li><p>When analysing data from a stratified random sample you need to use non-standard analytical methods (or non-standard versions of typical analytical methods) to account for and obtain the benefits of your stratified sample, in terms of increased precision. However, this is actually very straight forward to do with modern software and we will see how to do this in the complex survey practical sessions.</p></li>
</ul>
</details>
</section>
<section id="scenario-1" class="level3">
<h3 class="anchored" data-anchor-id="scenario-1">Scenario</h3>
<p>We will use the same basic scenario as for the simple random sampling exercise previously, where we are aiming to conduct a survey of <strong>n = 50</strong> public primary care health facilities. However, in these exercises we will take a stratified random sample. We will assume that there is likely to be substantial variation in at last some of our outcomes of interest between facilities in different sub-districts. For example, maybe some sub-districts have typically larger populations and so the facilities in those sub-districts experience a greater burden of patients leading to typically poorer outcomes of interest. To increase our chances of getting a representative sample for the target population we can therefore stratify the sampling by sub-district to ensure that no sub-district is over or under represented in the sample relative to its size. As we have the sub-district location of each facility in our sampling frame we can easily stratify our sampling by sub-district.</p>
<p>In the scenario/data there are just three sub-districts and they each contain quite different numbers of health facilities. We will assume that we are only interested in computing overall, district-level results for any outcomes. We will therefore need to split our sample size into three (i.e.&nbsp;so we have separate sample sizes for each sub-district) such that each sub-district’s sample size is <em>proportional to the number of facilities in that sub-district</em>. This will ensure that our results apply to the overall district level (if we used an equal sample size for each sub-district then the sub-districts with fewer health facilities in would be over-represented in the overall results, and vice versa).</p>
<p>Note: in a real study if you had data on additional characteristics that you thought were likely to be related to variation in the outcomes of interest you would probably further increase your chances of getting a representative and more statistically efficient sample by creating additional strata using those data.</p>
</section>
<section id="exercise-taking-a-proportionate-stratified-random-sample-using-excel" class="level3">
<h3 class="anchored" data-anchor-id="exercise-taking-a-proportionate-stratified-random-sample-using-excel">Exercise: taking a proportionate stratified random sample using Excel</h3>
<ul>
<li>Load the “Health facilities list - stratified random sample.xlsx” Excel spreadsheet.</li>
</ul>
<p><a href="https://youtu.be/x0kI-hybJh0">Video instructions: taking a proportionate stratified random sample using Excel</a></p>
<p><strong>Written instructions: taking a proportionate stratified random sample using Excel</strong></p>
<details>
<summary>
Read/hide
</summary>
<ul>
<li><p>If we know there is substantial variation in health facility characteristics on average between sub-districts we may want to reduce the chances of getting an unrepresentative sample size for one or more sub-districts and increase the precision of our estimates (for a given sample size) compared to taking a simple random sample, which is likely to happen when the sample size is very small (like n = 50). As mentioned previously in reality we would probably want to create strata based on additional variables related to our outcomes, maybe things like some measure of facility size, staffing, or resources etc, but we will just keep things simple here.</p></li>
<li><p>Therefore, instead of risking getting an unrepresentative distribution (number) of health facilities within each sub-district and less precise estimates, as would be likely with a simple random sample, we can take stratified random sample. Here we will see how to take a stratified sample such that the strata sample sizes are proportional to their relative population sizes. This ensures that the sample represents the distribution of strata seen in the population, which means we don’t need to weight our analyses.</p></li>
<li><p>In the “Health facilities list - stratified random sample.xlsx” Excel spreadsheet look at the <mark>Full facility list</mark> worksheet if it’s not already in view (you can change worksheet by clicking on the tabs at the bottom left of the window). Now look at the table titled <mark>Sub-district frequency table</mark> at the upper right of the spreadsheet. First we need to work out the proportion of facilities in each sub-district by dividing the number of facilities in each sub-district by the total number of facilities. Under the <mark>Population proportion</mark> heading click on the first empty cell for the Hills sub-district. Now enter <mark>=</mark> and then click on the <mark>Population frequency</mark> value for Hills (22), then type <mark>/</mark>, then click on the <mark>Population frequency</mark> total (at the bottom of the column: 245). The resulting formula should be: <mark>=G3/G6</mark>. Press enter to tell Excel to run the computation. The resulting value should be 0.089…</p></li>
<li><p>Repeat this for the other sub-districts. If you’ve done it correctly the total value under the <mark>Population proportion</mark> column should equal 1.</p></li>
<li><p>Next we need to use these proportions to compute the sample size required for each strata to maintain the strata sample sizes proportional to the strata population sizes. Under the <mark>Strata sample size</mark> column click on the first empty cell for the Hills sub-district. Now enter <mark>=</mark> then type <mark>ROUND(50*</mark>, then click on the cell containing the <mark>Population proportion</mark> value for Hills that you previously computed (0.089…), then type <mark>, 0)</mark>. The final full function should be <mark>=ROUND(50*H3, 0)</mark>. Press enter to tell Excel to run the computation. The resulting value should be 5.</p></li>
<li><p>Let’s explain the function you just used <mark>=ROUND(50*H3, 0)</mark>. ROUND works by rounding the first value in the brackets to the number of decimal places listed after the comma. So we’ve told Excel to round our computed sub-district sample size (50 x H3 - where H3 is the proportion of health facilities in the population in that sub-district) to 0 decimal places - i.e.&nbsp;to the nearest integer.</p></li>
<li><p>Now repeat this computation for the other two sub-districts. If you’ve done it correctly the total value under the <mark>Strata sample size</mark> column should equal 50.</p></li>
<li><p>Next we can take our stratified random sample. As a stratified random sample is just a repeated simple random sample within each strata all you now need to do is take a simple random sample of the relevant size for each sub-district, i.e.&nbsp;a simple random sample of 4 health facilities in the Hills sub-district and so on. In Excel it’s probably easiest to just create separate worksheets for each strata. To save you time, because it’s not something you probably need to practice, I’ve already created these three additional worksheets (the tabs along the bottom of the Excel spreadsheet): one containing the data for each sub-district</p></li>
<li><p>Therefore, create a new worksheet by clicking on the little + symbol to the right of the Hills worksheet. Then repeat the simple random sample process learned in the last exercise for each of the sub-district lists in turn. After randomising each list select the required number of facilities for that sub-district (starting from the top of the randomised list) and copy their details into your sample worksheet. Refer back to that exercise for the steps if needed. Note: you could also achieve a stratified random sample with proportional strata sizes by just randomising the total list of all health facilities and then selecting the first n health facilities from each sub-district as they appear in the randomised order, where n = the required sample size for each strata. However, that would be more time consuming.</p></li>
</ul>
</details>
<p><br></p>
</section>
</section>
<section id="exercise-3-systematic-random-sampling" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3-systematic-random-sampling">Exercise 3: Systematic random sampling</h2>
<section id="a-brief-overview-of-the-method-2" class="level3">
<h3 class="anchored" data-anchor-id="a-brief-overview-of-the-method-2">A brief overview of the method</h3>
<p>If you can reasonably assume that your sampling frame is randomly ordered with respect to your outcomes of interest and any causal factors that are related to your outcomes of interest then systematic random sampling should produce a similarly unstructured random selection as simple random sampling, and you can use the same “versions” of typical analytical methods that can be used when analysing data from a simple random sample. If your sampling frame is grouped in relation to a categorical characteristic that is related to your outcomes of interest, or is ordered in relation to a continuous/discrete characteristic that is related to your outcomes of interest, then you gain use it to obtain a random but similarly structured sample as obtained via proportionate stratified sampling. To gain the increased precision that can come from analysing a stratified random sample you would have to use relevant stratified analysis methods.</p>
<ol type="1">
<li><p>Take your sampling frame and select a random starting point (i.e.&nbsp;random unit of observation).</p></li>
<li><p>Based on your desired sample size calculate a “skip pattern”. This is just a number which then determines how many units of observation are skipped after your starting point before sampling another unit.</p></li>
<li><p>Sample your random starting point and based on your skip pattern all successive units of observation that your skipped sampling pattern “lands on” until you reach the end of your sampling frame, by which time you should have sampled your desired sample size (or just under - see the exercise).</p></li>
</ol>
</section>
<section id="advantages-and-disadvantages-2" class="level3">
<h3 class="anchored" data-anchor-id="advantages-and-disadvantages-2">Advantages and disadvantages</h3>
<details>
<summary>
Read/hide
</summary>
<p><br></p>
<p><strong>Advantages</strong></p>
<ul>
<li><p>Stratified random sampling can be useful when sampling physical units that are ordered when you have no sampling frame, but you know (at least approximately) how many units there are. For example, if you want to sample n refugee tents in a camp that are ordered in rows but there is no list of all tents, you could use a drone to take an aerial photo and estimate the total number of tents (e.g.&nbsp;count a few rows to get a row average and multiply by the total number of rows). You could then pre-plan a sampling route through the camp and apply the method, taking the first tent as your first sampling frame unit and so on.</p></li>
<li><p>Another advantage that systematic random sampling has over simple random sampling is that it can reduce the chances that you will obtain a non-representative sample in relation to a characteristic of interest (e.g.&nbsp;an outcome of interest or a characteristic that is known to be causally related to your outcome of interest). For categorical characteristics this has the same result as for proportionate stratified sampling, but if there are many (often small) category levels (i.e.&nbsp;strata), it can be quicker and easier to use systematic random sampling, because all you need to do is order by that characteristic and then take your systematic random sample, and you will get (at least approximately) the proportionate sample size for each category level.</p></li>
<li><p>This also works for numerical characteristics, where stratified sampling cannot necessarily be applied easily or would force you to crudely group the sampling frame based on cut points. Here, all you need to do is order the sampling frame in relation to the numerical characteristic that is either your outcome of interest, or is assumed to be related to your outcomes of interest, and then take your stratified random sample. You will then ensure that your sample has a representative distribution of that numerical characteristic. For example, if the number of doctors in a health facility is likely to be related to the health facility outcomes we are interested in and we have data on those doctor numbers we can use systematic random sampling to ensure that we get a sample that has a distribution of doctor numbers that match the distribution in the sampling frame/target population.</p></li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li><p>Systematic random sampling is a bit more complicated to implement than simple random sampling.</p></li>
<li><p>As with stratified random sampling you need additional data on important characteristics of your units of observation that are related to the characteristics or relationships of interest to obtain a clear benefit from this approach, and such data is often difficult, costly or impossible to obtain.</p></li>
<li><p>Most critically, if there is a repeating pattern to the ordering of your sampling frame in terms of the distribution of characteristics that affect your outcomes of interest then a systematic random sample may produce a seriously biased/unrepresentative sample. This is usually the case when the pattern repeats regularly. For example, if you are using systematic random sampling to sample from a list of health facilities that are ordered from small to large within each area, and your sample size is such that you’re only selecting one or a few per area, the pattern might ensure that you only select typically smaller/larger facilities in each area. Be careful!</p></li>
</ul>
<p><strong>When to use systematic random sampling?</strong></p>
<p>Clearly systematic random sampling can have some advantages over simple random sampling if used carefully, but what about in relation to stratified random sampling? Remember stratified random sampling can use either simple or systematic random sampling to take the samples within each strata. Therefore, it depends on your aims and there’s no single answer for all circumstances. However, broadly speaking if you have good data on what are likely to be important strata for your characteristics or relationships of interest then a stratified random sample may be the better choice This is because compared to simple random sampling stratified random sampling is more likely to produce a representative sample while also being likely to increase the precision of your estimates (i.e.&nbsp;increase your statistical efficiency) compared to systematic random sampling, but it also avoids the risk of producing a biased sample that systematic random sampling can result in when there are unrecognised, typically small-scale, meaningful repeating patterns in the ordering of the sampling frame.</p>
<p>However, for completeness we will practice below how to take a systematic random sample when we have some additional data on important strata.</p>
<p>Lastly, note that one form of systematic random sampling is often used in the first stage of multi-stage cluster samples to take a non-stratified random sample of primary-stage clusters (often villages or city blocks) with <em>probability proportional to the size of primary-stage clusters</em>. This involves a slight modification of the approach we will see below, and as it’s typically only used in this specific circumstance we won’t look at it further.</p>
</details>
</section>
<section id="scenario-2" class="level3">
<h3 class="anchored" data-anchor-id="scenario-2">Scenario</h3>
<p>We will use the same basic scenario as for the simple random sampling and stratified random sampling exercises previously, where we are aiming to conduct a survey of 50 public primary care health facilities. However, in this exercise we will take a systematic random sample. We will use the stratified random sampling exercise sampling frame where the health facilities were ordered into sub-district groups. As long as there is no smaller scale pattern in the ordering of the list a systematic random sample should ensure a random sample of health facilities while also ensuring the sample is evenly distributed across the three sub-districts.</p>
</section>
<section id="exercise-taking-a-systematic-random-sample-using-excel" class="level3">
<h3 class="anchored" data-anchor-id="exercise-taking-a-systematic-random-sample-using-excel">Exercise: taking a systematic random sample using Excel</h3>
<ul>
<li>Load the “Health facility list - systematic random sample.xlsx” Excel spreadsheet.</li>
</ul>
<p><a href="https://youtu.be/S-aZjcmt6PY">Video instructions: taking a systematic random sample using Excel</a></p>
<p><strong>Written instructions: taking a systematic random sample using Excel</strong></p>
<details>
<summary>
Read/hide
</summary>
<ul>
<li><p>To save time we have already created a numerical sequence in the first column from 1 to 245. This will be used to identify our sampled health facilities.</p></li>
<li><p>First, order the list by the variable “no_drs”: click anywhere on the values and from the top menu click <mark>Data</mark> then <mark>Sort</mark>. In the sort tool that appears under <em>Column</em> where it says <em>Sort by</em> click the drop-down menu and select <mark>no_drs</mark>. Then click <mark>OK</mark>. The list should now be ordered by the number of doctors per health facility, and our systematic random sample will now ensure we get a representative sample across the range of numbers of doctors per health facility.</p></li>
<li><p>Next, calculate the skip pattern <em>k</em>. This is calculated as N/n, where N = total sampling frame size and n = sample size. If the result is a whole number (integer) use this value, or if not round up to the nearest whole number. Therefore, in cell G1 enter skip and press enter. Then in cell G2 enter <mark>=245/50</mark> and press enter. You should get the value 4.9. Therefore, we round this up so our skip pattern <em>k</em> = 5.</p></li>
<li><p>Next we need to select a random starting point between the first unit of observation and that corresponding to our skip pattern <em>k</em>, i.e.&nbsp;a random number between 1 and 5. To do this use the Excel function <em>randbetween</em>. In cell H1 enter the heading facility_selection_id. Then click on cell H2 and enter <mark>=randbetween(1, 5)</mark> and press enter. This will create a random value between 1 and 5 for the random starting point. Next overwrite this value with the same value by clicking on the cell and typing the number corresponding to the random value (e.g.&nbsp;if the random value is 3 click on the cell and type 3). This ensures that Excel won’t create a new random value each time you update any other functions.</p></li>
<li><p>Then click on cell H3 and type <mark>=H2+5</mark>. Then press enter. Then click again on cell H3 and then double click on the small solid square at the bottom right of the selection box that appears around cell H2 to extend the formula down to the bottom of the data. This new column then lists the IDs of the facilities that our systematic random sample has selected. Note that for this to work the original facility ID <strong>must</strong> be a count from 1 to n, where n is the maximum number of facilities. Note also that the facility_selection_id values keep going beyond the maximum value of the original facility ID.</p></li>
<li><p>Therefore, click on the little + symbol to the right of the Sheet1 tab to create a new spreadsheet. Then click back to Sheet1. Now copy and paste the values in the facility_selection_id column from the first value until the greatest value that is ≤245. This is your sample list of facility IDs, which should be both a random sample and implicitly stratified by number of doctors. Therefore, you would have to either go back to the original list and copy the details of each facility, as per the sampled IDs, or use the MATCH function in Excel to match up values, but we do not look at that here.</p></li>
<li><p>Finally, if you go to Sheet2 and highlight all the IDs and look at the bottom right of the window Excel tells us the count (i.e.&nbsp;number of selected rows) of IDs is 49. So we are missing one from our targeted sample size. This is just due to the rounding of the skip pattern. If the original skip pattern (before rounding) had been 5 we it would have resulted in a sample size of 50. Therefore, to get our desired sample size we just need to randomly select one more health facility by going back to the start of the list once you reach the end (e.g.&nbsp;for our skip pattern of 5 if your final selected facility was number 244 then we’d count 245, 1, 2, 3, and then number 4 would be our final selected facility).</p></li>
</ul>
</details>
</section>
</section>
<section id="single-stage-cluster-sampling-and-multi-stage-cluster-sampling" class="level2">
<h2 class="anchored" data-anchor-id="single-stage-cluster-sampling-and-multi-stage-cluster-sampling">Single-stage cluster sampling and multi-stage cluster sampling</h2>
<p>The following optional information is just for awareness and understanding purposes but we will not practice either of these methods.</p>
<details>
<summary>
Read/hide
</summary>
<section id="cluster-random-sampling" class="level3">
<h3 class="anchored" data-anchor-id="cluster-random-sampling">Cluster random sampling</h3>
<p>Cluster sampling involves sampling higher-level units of observation, such as households, schools, villages etc, which contain your lower-level units of observation, typically individuals. If you then also sample units within clusters (i.e.&nbsp;not every unit is selected) then you are using some form of multi-stage cluster sampling method, and that is too complicated for us to look into further, but see below for a bit more detail. However, if you are sampling clusters and then <em>selecting</em> all eligible units within each sampled cluster for data collection you can simply use any of the methods previous covered to sample your clusters. For example, if you wanted to survey community members in a number of communities and you could construct a sampling frame listing all the households in each community you wanted to survey, but not the household members, then you could take a simple random sample of households from your list and then select all eligible individuals within every sampled household for data collection. Or you may wish to stratify the sampling if you also collected data on, say, the total size of each community etc.</p>
<p>Either way this would result in a representative sample (on average) with no need to re-weight the data, unlike if you had also sampled individuals within households. However, when you take a cluster sample you need to account for the clustering in your analysis. This is because standard methods of analysis assume observations (i.e.&nbsp;data points) are statistically independent from one another, but clearly individuals within the same household etc are not independent, and they therefore do not provide the same amount of statistical information about a population as fully independent observations would. Therefore, ignoring clustering in analyses results in falsely high levels of precision/power. We will see one way that you can account for clustering in the complex survey practical sessions.</p>
</section>
<section id="multi-stage-clustered-random-sample" class="level3">
<h3 class="anchored" data-anchor-id="multi-stage-clustered-random-sample">Multi-stage clustered random sample</h3>
<p>Multi-stage clustered random sampling is far too complicated to go into for this module, but we will see how to analyse data from multi-stage clustered samples in the complex survey practical sessions. It is typically only used by large-scale household surveys, such as the <em>Demographic and Health Surveys</em> by USAID and its in-country partners. Such projects almost always use professional statisticians or survey methodologists. In brief though, this approach is actually some combination of the earlier methods covered above, and usually combines a first stage systematic random sample, with probability proportional to size to select primary sampling units (usually census units, often called “enumeration areas”, that correspond to villages or city blocks), with a second stage of sampling of households, which either again uses systematic random sampling, but typically with equal probabilities of selection, or a simple random sample. However, there are many variations with possibly additional levels of sampling. This means that the probability of selection of the ultimate sampling units is never equal with such methods and complicated sampling weights need to be calculated to ensure analyses produce unbiased results.</p>
</section></details>


</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>