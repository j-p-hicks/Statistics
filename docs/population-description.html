<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>population-description</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-beb392ddb238527d957dbf35687def22.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./population-description.html">4. Population description</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./website-information.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to use this website</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Probability sampling</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">2. Introducing SPSS &amp; preparing data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction-to-spss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.1. Introducing SPSS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preparing-a-dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.2. Preparing a dataset</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sample-description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Data exploration &amp; sample description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./population-description.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">4. Population description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sample-size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Sample size calculations</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">6. Bivariate tests for numerical variables</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./independent-t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.1. Independent t-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./independent-t-test-skewed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.2. Independent t-test with skewed data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./paired-t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6.3. Paired t-test</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">7. Bivariate tests for categorical variables</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi-sq-independence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.1. Chi-square test of independence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi-sq-goodness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.2. Chi-square goodness of fit test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./paired-categorical-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7.3. Paired categorical variable test (McNemar’s test)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">8. Regresson modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.1. Linear regression I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression-further.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.2. Linear regression II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8.3. Logistic regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complex-sampling-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Complex sampling design analysis</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#population-characteristics" id="toc-population-characteristics" class="nav-link active" data-scroll-target="#population-characteristics">Population characteristics</a></li>
  <li><a href="#rationale" id="toc-rationale" class="nav-link" data-scroll-target="#rationale">Rationale</a>
  <ul class="collapse">
  <li><a href="#descriptivesample-statistics-and-inferential-statistics" id="toc-descriptivesample-statistics-and-inferential-statistics" class="nav-link" data-scroll-target="#descriptivesample-statistics-and-inferential-statistics">Descriptive/sample statistics and inferential statistics</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">Confidence intervals</a></li>
  </ul></li>
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice">Practice</a>
  <ul class="collapse">
  <li><a href="#scenario" id="toc-scenario" class="nav-link" data-scroll-target="#scenario">Scenario</a></li>
  <li><a href="#exercise-1-estimate-a-mean-and-a-proportionpercentage-and-their-associated-95-confidence-intervals-in-relation-to-the-overall-target-population" id="toc-exercise-1-estimate-a-mean-and-a-proportionpercentage-and-their-associated-95-confidence-intervals-in-relation-to-the-overall-target-population" class="nav-link" data-scroll-target="#exercise-1-estimate-a-mean-and-a-proportionpercentage-and-their-associated-95-confidence-intervals-in-relation-to-the-overall-target-population">Exercise 1: estimate a mean and a proportion/percentage and their associated 95% confidence intervals in relation to the overall target population</a></li>
  <li><a href="#exercise-2-estimate-means-and-proportionpercentages-and-their-associated-95-confidence-intervals-in-relation-to-subgroups-within-the-target-population" id="toc-exercise-2-estimate-means-and-proportionpercentages-and-their-associated-95-confidence-intervals-in-relation-to-subgroups-within-the-target-population" class="nav-link" data-scroll-target="#exercise-2-estimate-means-and-proportionpercentages-and-their-associated-95-confidence-intervals-in-relation-to-subgroups-within-the-target-population">Exercise 2: estimate means and proportion/percentages and their associated 95% confidence intervals in relation to subgroups within the target population</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="population-characteristics" class="level1">
<h1>Population characteristics</h1>
<hr>
<p>In this practical we will practice some common inferential analysis methods to estimate common univariate statistical properties of characteristics in a population.</p>
<p><br></p>
</section>
<section id="rationale" class="level1">
<h1>Rationale</h1>
<hr>
<p>Previously we saw how we can describe useful properties about univariate characteristics in a sample, such as the mean of a numerical variable and the percentage frequency of one level of a categorical variable. However, we are usually ultimately interested in understanding these same useful statistical properties of our variables of interest but in our target population, not just our specific sample, and that’s what we’ll do here. To do this, we want to compute confidence intervals to go with the sample statistics for our univariate characteristics of interest, where the sample statistics are our best “point estimates” (i.e.&nbsp;single values) of the unknown population parameters of interest, while the confidence intervals allow us to make inferences about the likely range of values that those unknown population parameters lie within, given that we can only estimate them with some amount of sampling error. Usually, when we are estimating population parameters that are some univariate characteristic of a variable we call the variable an outcome variable, but to be clear there’s nothing special about an outcome variable as opposed to any other variable.</p>
<p>We will also see how we can calculate such measures for subgroups within the target population of interest.</p>
<p>If you are confident about the concepts of descriptive/sample statistics and inferential statistics, and with the idea and interpretation of a confidence interval, then feel free to skip to the exercises. However, if you are not confident about these topics then we suggest reading the following.</p>
<section id="descriptivesample-statistics-and-inferential-statistics" class="level2">
<h2 class="anchored" data-anchor-id="descriptivesample-statistics-and-inferential-statistics">Descriptive/sample statistics and inferential statistics</h2>
<details>
<summary>
Read/hide
</summary>
<p>It’s important to be very clear on the distinction between descriptive and inferential statistics.</p>
<p><strong>Descriptive statistics</strong></p>
<p>In summary, descriptive statistics, which are sometimes also called sample statistics or summary statistics, summarise statistical properties of individual variables (via “univariate” analyses) or summarise associations between variables (typically via “bivariate” analyses) <strong>as they exist in your sample</strong>. For example, common univariate statistics are means, which summarise the typical value of a numerical variable, such the the mean systolic blood pressure in mmHg in the sample, and proportions/percentages, which summarise the frequency of occurrence of some event or condition, represented as one level of a binary/categorical variable, such as the proportion/percentage of smokers in the sample (as opposed to non-smokers).</p>
<p>Assuming you have no sources of bias in your study these descriptive statistics will reflect the truth about your sample. For example, if you have no bias then the true mean systolic blood pressure in mmHg in your sample will be the sample mean of all the systolic blood pressure values.</p>
<p><strong>Inferential statistics</strong></p>
<p>However, on their own these descriptive statistics do not allow you to make robust generalisations about the same statistical properties of individual variables or associations between variables in your target population. Remember, when we are interested in the statistical properties of individual variables or associations between variables in a target population we call the statistical quantities that reflect these properties “population parameters”, and we assume that they are fixed for the population and time point of interest. In theory, if we could take a census of the whole target population and measure our outcomes and associations of interest without error then we could measure our population parameters without error. However, almost always our target population is far too large to do this and we need to take a sample, ideally using robust, representative, probability sampling methods, as we have seen. The equivalent sample statistic is then our best “point estimate” of the population parameter of interest, but as the name implies it is an estimate with an unquantified amount of error.</p>
<p>It is easy to see why this is the case. Let’s assume we want to infer the mean systolic blood pressure in mmHg for some target population that contains 100,000 individuals. Let’s assume we take a simple random sample of just 2 individuals and measure, without error, their systolic blood pressure in mmHg. The mean of these 2 systolic blood pressures values will be the true mean systolic blood pressure for our microscopically small sample of 2! However, does anyone believe that a mean of just two individuals’ systolic blood pressures, however representative they are, is likely to accurately reflect the true mean systolic blood pressure for the overall target population? Of course by chance it might be really accurate, but in general we’re very likely to get a sample that produces an estimated mean that is not reflective of the true population-level mean. And if we instead took another simple random sample of 2 other individuals and computed a new mean systolic blood pressure it would be very likely to be different from the first mean. So if each sample mean would vary, and we can usually only collect one sample, how can we tell how accurate our sample mean is?</p>
<p>This is the problem of sampling error and sample size. Each sample would likely produce a different estimate of our fixed population parameter, and depending on the sample size the estimate would be likely to vary more/less between each repeated sample.</p>
<p>Therefore, to let us infer the likely value of our population parameter we need to combine our sample statistic (i.e.&nbsp;our best point estimate) with some inferential measure. As we will discuss in the relevant lectures, this can be done most effectively by calculating the corresponding confidence intervals for the sample statistic, or a different approach involving hypothesis testing would be to compute an associated p-value. Note: this broad inferential approach is not just for when we are infering the statistical properties of individual variables in a target population, but also for when we are infering associations in a target population. We combine the relevant sample statistic with a suitable inferential measure.</p>
<p><strong>Descriptive statistics and descriptive studies/research</strong></p>
<p>The terminology around descriptive statistics and descriptive studies can be a source of confusion. The key thing to remember is that <strong>descriptive statistics describe samples only</strong>, and are used in all studies to initially explore our data, plan our analyses, and describe the key characteristics of the sample so we can judge how representative our sample is compared to the target population in terms of these key characteristics. Whereas a descriptive study, or a study where one or more quantitative research questions are about description, is almost always about the goal of <strong>describing characteristics/associations in a target population</strong> via sample and using inferential statistics (even if that target population is not clearly specified). You can certianly find studies that have only described a sample alone using sample statistics and no inferential measures, but in my experience that always seems to be because the authors have misunderstood statistical inference and don’t seem to understand what they are doing or how limited their results are.</p>
<p>So if studies say they are aiming to <em>describe</em> characteristics or associations in a given target population, and they have taken a sample from that target population to do this, then if they know what they are doing then they mean that they are going to use inferential statistics (typically confidence intervals around point estimates) to try and infer the likely (but ultimately unknown) values for those characteristics/associations in the target population.</p>
</details>
</section>
<section id="confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals">Confidence intervals</h2>
<details>
<summary>
Read/hide
</summary>
<p><strong>Interpretation</strong></p>
<blockquote class="blockquote">
<p>Note: formally the interpretation of a confidence interval applies to a fully defined target population that you have sampled using a probability sampling method. Once you start trying to interpret a confidence interval in relation to a target population that you haven’t sampled from, or based on an analysis of a sample taken using some kind of purposive approach, then strictly speaking there is no robust, mathematical basis for that interpretation. However, you can certainly think about interpreting a confidence interval in relation to a different target population that you didn’t sample from, and you can certainly calculate confidence intervals based on purposively sampled samples, but you need to carefully consider how these factors affect the robustness and validity of the interpretation.</p>
</blockquote>
<p>Confidence intervals take the form of a lower and upper value that surround the point estimate. For example, let’s say we estimate the mean age in a target population as 30, based on computing the mean age in a simple random sample from that population. Let’s assume we then compute a 95% confidence interval around that mean with lower and upper values of 25 and 35. We would usually write these statistics all together as:</p>
<blockquote class="blockquote">
<p>Mean age: 30 (95% CI: 25, 35)</p>
</blockquote>
<p>Where CI = confidence interval. Note, we separate the lower and upper interval via a comma not a hyphen “-”, as hyphens can be mistaken for negative symbols.</p>
<p>Strictly speaking confidence intervals are a mathematical statement about hypothetical resampling in relation to our point estimate of interest. Unfortunately, this can be quite a confusing, technical concept. More concretely, what this confidence interval is telling us is that if we were to repeat our random sampling process infinitely many times and each time we were to compute the mean age and its 95% confidence interval then 95% of those 95% confidence intervals would contain the true (but unknown) value of the mean age in the target population. Hence, we can never be certain what the exact mean age of the target population is based on the confidence interval, but it does give us an interval (i.e.&nbsp;a range of values) within which it is likely to lie. Yes, this is a frustratingly indirect statement about the true mean that we want to measure, but that is how the theory works, and that is the technically correct interpretation.</p>
<p>Note: many people, including many researchers/papers, would say we can be “95% confident” the true (but unknown) population parameter lies within the 95% confidence interval. However, technically speaking this phrase “95% confident” doesn’t have any precise, concrete, mathematical meaning. Also, the probability that the population parameter of interest lies within a given confidence interval is either 100% or 0%. We could know which of these scenarios was true if we were able to measure the whole population and calculate the population parameter. So it’s pretty questionable whether this is a valid or useful approach, but you will see it often.</p>
<p>Note: There is nothing special about a 95% confidence interval compared to a higher or lower level of confidence, such as a 90% confidence interval. However, for a given variable as you increase the confidence level the interval increases. For example, for our hypothetical situation above we may find a 99% confidence interval around our mean age of 30 is 10 and 50. While we may find a 80% confidence interval would be from 28 to 32. The interpretation remains the same. For example, for 99% confidence intervals we obtain confidence interval limits that, if we were to repeat the sampling and estimation and infinite number of times, would contain the true population parameter value 99% of the time.</p>
<p>Therefore, there is a trade-off in the usefulness of the confidence interval as you vary the confidence level. Too high a confidence level results in a high level of certainty but for a very wide interval, while too low a confidence level results in a low level of certainty but for a very narrow (precise) interval. The widespread use of 95% confidence intervals in the health sciences is largely just a convention, i.e.&nbsp;due to tradition. For a given confidence level, all else being equal, if we increase the sample size the interval will become narrower. Therefore, if you have sufficient sample size then a higher level of confidence would clearly be preferable.</p>
<blockquote class="blockquote">
<p>Note: it is absolutely critically important to be aware, and when interpreting a confidence interval to always remember that, the accuracy or validity of the above interpretation of a confidence interval depends <em>entirely</em> on there being no bias in the study. Confidence intervals quantify the amount of variation in the sample data relative to the sample size. So they allow us to decide how closely we are likely to have estimated the population parameter of interest given the sample size and variation in the outcome, which may come from the fundamental/natural variation in the outcome’s values in that target population, and some extra random variation may come from non-differential error like truely random measurement error.</p>
</blockquote>
<blockquote class="blockquote">
<p>However, confidence intervals tell you <strong>nothing</strong> about any sources of bias, such as selection bias, or any non-random (differential) sources of error, like non-random missing data or non-random measurement error. Remember, study bias can occur throughout the entire study cycle, from planning the data collection tools through to reporting the study results. Therefore, if the study results are affected by any sources of bias, which is inevitable to some extent, then the accuracy and validity of the confidence interval will be affected, usually to an unknown extent. For example, using the age example from before: if older people were less likely to agree to participate in the survey that collected their age data, then this would be a form of selection bias, and the resulting 95% confidence interval and point estimate for the mean age of that population would be skewed downwards, and the confidence intervals may no longer include the true (but unknown) value of the mean age in the population 95% of the time. Again, it is usually not possible to estimate the effect of such biases, so they must be judged more qualitatively via rigorously exploring and understanding all possible sources of bias and the likely size of their impact.</p>
</blockquote>
<p><strong>Computing confidence intervals</strong></p>
<p>Don’t worry: we will leave the computation of our confidence intervals up to the software. However, when computing a confidence interval we need to make an assumption about the type of probability distribution that we assume the sample statistic of interest comes from (i.e.&nbsp;the probability distribution we would see if we were to take many repeated samples, calculate the sample statistic each time, and plot their distribution on a histogram). Here we will just be focusing on estimating population-level means for numerical outcomes and percentages for the levels of a binary/categorical outcome.</p>
<p>For continuous variables a reasonable assumption about the appropriate probability distribution will often be the normal distribution, and if we plot the distribution of the variable’s values and they are approximately normal it is usually safe to assume a normal distribution will be appropriate for the confidence interval. If the distribution is skewed, as will usually be the case for discrete variables such as counts, we can try and transform the distribution of the outcome variable before computing the confidence interval, while still assuming a normal distribution when computing the confidence interval, or we can use a more appropriate distribution, but that is beyond this course.</p>
<p>For binary/categorical variables you can also assume a normal distribution, even though this will never be correct, as long as it is approximately correct. When the percentage being estimate isn’t too small or too large, then the normal distribution is usually an okay approximation. “Too small” and “too large” are usually taken to be &gt;10% and &lt;90%, but these are just really rough rules of thumb. However, we can compute confidence intervals that make assumptions about the likely probability distribution of the sample statistic that are more appropriate for binary/categorical variables. There are actually many such possible methods, with little clear evidence on which is best and under what circumstances. We will look at this in a bit more detail in the exercise.</p>
</details>
<p><br></p>
</section>
</section>
<section id="practice" class="level1">
<h1>Practice</h1>
<hr>
<section id="scenario" class="level2">
<h2 class="anchored" data-anchor-id="scenario">Scenario</h2>
<p>You and your colleagues have been tasked by the Kapilvastu district authorities in Nepal to help them understand the problem of high blood pressure and hypertension, and the associations between socio-demographic and health related characteristics and blood pressure level/hypertension. You have carried out a cross-sectional survey to address these aims, and collected data on systolic blood pressure, common socio-demographic characteristics, and some additional health-related characteristics. So far, you have cleaned and prepared the data, and computed descriptive statistics for key characteristics. As per your statistical analysis plan you now need to use the data to estimate the likely mean systolic blood pressure and prevalence (%) of hypertension for the whole target population and for women and men separately.</p>
</section>
<section id="exercise-1-estimate-a-mean-and-a-proportionpercentage-and-their-associated-95-confidence-intervals-in-relation-to-the-overall-target-population" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-estimate-a-mean-and-a-proportionpercentage-and-their-associated-95-confidence-intervals-in-relation-to-the-overall-target-population">Exercise 1: estimate a mean and a proportion/percentage and their associated 95% confidence intervals in relation to the overall target population</h2>
<blockquote class="blockquote">
<p>Aim: estimate the mean systolic blood pressure (mmHg) and the prevalence (%) of hypertension and their associated 95% confidence intervals to allow statistical inferences to be drawn about the typical level of systolic blood pressure and the prevalence of hypertension in the overall target population.</p>
</blockquote>
<ul>
<li><p>First, load the analysis-ready “SBP data final.sav” SPSS dataset.</p></li>
<li><p>Next, in the “Exercises” folder also open the “Exercises.docx” Word document and scroll down to <strong>Population description</strong>. You can enter the requested values here and then compare them to the answers given.</p></li>
<li><p>Next, follow the instructions below on how to compute two common univariate inferential statistics for numerical and categorical variables, specifically means and percentages, with associated confidence intervals to allow inference about these measures in the entire target population.</p></li>
</ul>
<p><br></p>
<p>Sorry: at present there is no video-based set of instructions for this method.</p>
<p><strong>Written instructions: calculating and their 95% confidence intervals for continuous/discrete numerical variables with approximately normal distributions in SPSS</strong></p>
<details>
<summary>
Read/hide
</summary>
<ul>
<li><p>To compute a confidence interval for any sample statistic requires us to make an assumption about the probability distribution we believe the sampling distribution of the sample statistic to have come from. We can make this decision based on our knowledge of the likely data generating process and the shape of the distribution (as visualised via a histogram). If a numerical variable is approximately normally distributed then we can describe the typical value (or more technically the central tendency) via the sample mean and compute a 95% confidence interval around this mean, to allow us to make a statistical inference about the likely population mean.</p></li>
<li><p>When a numerical variable is approximately normal we can usually safely compute a confidence interval based on a normal distribution (i.e.&nbsp;we are unlikely to go too far wrong and compute a very biased confidence interval if this is the case). However, in practice most software will actually compute one based on a t-distribution. This is because a t-distribution is appropriate for continuous data that follow a a symmetrical, bell-curve shape, like the normal distribution, but it allows for more variation at smaller sample sizes by having wider “tails” at either end of the distribution. This can be shown to give more accurate confidence intervals that include the true population parameter at the desired coverage rate. For example, a 95% confidence interval for a mean based on a small sample size (e.g.&nbsp;&lt;30) computed via the normal distribution might exclude the true population parameter &gt;5% of the time, while a t-based distribution should exclude it only 5% of the time as desired. Technically, if you use a normal distribution to compute a confidence interval this is only valid when the sample size is infinite, and at larger sample sizes the normal distribution and the t-distribution become equivalent, so there is no real reason not to use the t-distribution over the normal when possible.</p></li>
</ul>
<blockquote class="blockquote">
<p>Note: technically speaking we are just considering analytical confidence intervals based on probability distribution functions here. However, there are empirical/numerical approaches such as bootstrap confidence intervals, which you may can read a bit about <a href="https://acclab.github.io/bootstrap-confidence-intervals.html">here</a></p>
</blockquote>
<ul>
<li><p>So let’s check that the variable is approximately normally distributed, otherwise the mean may not be the best measure of the typical value of the variable, and its 95% confidence intervals would not be accurate (technically speaking they may under or over cover the true interval on average).</p></li>
<li><p>From the main menu go to: <mark>Graphs &gt; Histogram</mark> Then in the <mark>Histogram</mark> tool click on the <mark>sbp</mark> variable and add it to the <mark>Variable:</mark> box by clicking the blue arrow next to the box. Tick the <mark>Display normal curve</mark> box below. This will display a theoretical normal distribution curve based on the mean and SD of the variable, which helps you to see how closely the data match the distribution we would expect if they were normally distributed. Then just click <mark>OK</mark>.</p></li>
<li><p>What does the distribution of the data look like? I would say there is no evidence of any important skew.</p></li>
<li><p>Now let’s compute the mean of the variable and a t-based 95% confidence interval to allow us to make a statistical inference about the likely value of the true (but unknown) mean systolic blood pressure in mmHg in the entire target population.</p></li>
<li><p>To compute our t-based 95% confidence intervals we will use a “one-sample t-test”. There are other types of “t-tests” that we cover, which are used for comparing means between groups, but we don’t look at the one-sample t-test in detail as it is rarely used. If you wish to read about it a brief overview with SPSS instructions is <a href="https://statistics.laerd.com/spss-tutorials/one-sample-t-test-using-spss-statistics.php">here</a>. In brief though, a one-sample t-test tests the hypothesis that the mean of the sample variable equals a given value that you choose. We are not interested in the hypothesis testing aspect of this test, but we can use it to give us the mean of a numerical variable and the t-based 95% confidence intervals for that estimated mean.</p></li>
<li><p>To do this from the menu go: <mark>Analyze &gt; Compare Means &gt; One-Sample T Test</mark>. Then add the <mark>sbp</mark> variable into the <mark>Variables:</mark> box using the arrow. Note that we leave the <mark>Test Value:</mark> box with the default 0 (see below for why). Then click <mark>OK</mark> to run the test.</p></li>
<li><p>You will get three tables returned in the results window. The “One-Sample Statistics” table presents the sample size for the variable, which is useful because you should always present the sample size (i.e.&nbsp;count) for any estimate and the relative frequency (e.g.&nbsp;percentage) of complete/missing data for the variable.</p></li>
</ul>
<blockquote class="blockquote">
<p>Note: by default SPSS removes any observations from the variable with missing values when computing the results.</p>
</blockquote>
<ul>
<li>You can then look at the “One-Sample Test”. The first column we are interested in is the “Mean Difference”. Technically, the one-sample t-test compares the mean of the variable to an assumed population mean value that you choose. By default SPSS sets this value as 0, and indeed as above we left it as 0. Therefore, when the test compares the difference between the outcome mean and 0 it is subtracting 0 from the outcome mean, and of course anything minus 0 is just itself. Hence, the “Mean Difference” is actually just our outcome mean. You can also see the sample mean or point estimate of the population mean in the “One-Sample Statistics” table, but they will match. Then we can also see the t-based 95% lower and upper confidence intervals for the mean difference under the “95% Confidence Interval of the Difference” “Lower” and “Upper” columns. Again though, while these are technically the confidence intervals for the mean difference as the difference is between the outcome mean and 0 we can just treat them as confidence intervals for the outcome mean.</li>
</ul>
</details>
<p><br></p>
<p><strong>Written instructions: calculating proportions/percentages and their 95% confidence intervals for categorical variables</strong></p>
<details>
<summary>
Read/hide
</summary>
<blockquote class="blockquote">
<p>Note: this approach is applicable to both binary variables or categorical variables with three or more category levels. In the case of a categorical variable with three or more category levels we just treat each category level as a separate binary variable in practice (with each unit of observation either being in that category or not). For example, for the variable “education level” with category levels “none”, “primary”, and “more than primary” we estimate the proportion/percentage of individuals in the 1) “none” category vs “primary or more than primary”, 2) the “primary” category vs “none or more than primary”, and 3) the “more than primary” vs “none or primary”.</p>
</blockquote>
<ul>
<li><p>As above, to compute a confidence interval requires an appropriate probability distribution given the data. Clearly, a binary variable cannot formally be normally distributed: it can only take values of 0 and 1. However, as long as the underlying proportion is not “too extreme” we can actually treat it as an approximately normally distributed variable and compute normal-based confidence intervals. By “too extreme” the usual rule of thumb is the proportion for the variable must be &gt;0.1 and &lt;0.9. Beyond these limits the implied distribution becomes too non-normal for the approximation to be useful. For example, the lower/upper confidence interval will often be &lt;0 or &gt;1, and the bias in the accuracy of the confidence interval’s coverage becomes more substantial.</p></li>
<li><p>Alternatively and more appropriately, we can use a probability distribution formally applicable to a binary variable and our assumed data generating process, such as the binomial distribution. Generally, such a confidence interval is called a binomial proportion confidence interval.</p></li>
<li><p>Unlike for numeric variables that are approximately normal there are actually a large number of different approaches available though, and there is a surprisingly limited amount of research comparing these methods under different situations. However, the current rough consensus appears to be that the “Wilson score interval” method with the continuity correction generally does well. There is a Wikipedia page with a great summary of the situation [here] (https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval#Comparison_and_discussion).</p></li>
<li><p>SPSS offers the option to calculate a big range of these different binomial proportion confidence intervals all at the same time. Let’s see how we can do this for a categorical variable with three category levels for each category level.</p></li>
<li><p>From the menu go <mark>Analyze &gt; Compare Means &gt; One-Sample Proportions</mark>. Then add the <mark>htn</mark> variable from the <mark>Variable</mark> box into the <mark>Test Variable(s):</mark> box using the blue arrow.</p></li>
<li><p>Next click on the button labelled <mark>“Confidence intervals”</mark> at the top right. Then under <mark>Select Type(s)</mark> tick <mark>Clopper-Pearson (“Exact”)</mark>, which is based directly on the binomial distribution, <mark>Wald</mark>, which just uses the normal distribution (often called normal approximation confidence intervals), <mark>Wilson Score</mark> and lastly <mark>Wilson Score (Continuity Corrected)</mark>. Then click <mark>Continue</mark>.</p></li>
<li><p>Now we need to decide which category level we want to calculate our proportion and confidence intervals for. If you right click on the htn variable and select <mark>Variable Information</mark> you can see that the variable is numerically coded with 1 = hypertension and 0 = no hypertension. So we want to look at the proportion/percentage of individuals coded 1 (with hypertension).</p></li>
<li><p>To do this in the <mark>Define Success</mark> area select the button next to <mark>Value(s)</mark> and in the box to right of this button enter the value 1. Then click <mark>OK</mark>.</p></li>
</ul>
<blockquote class="blockquote">
<p>Note: if you have a categorical variable coded with letters or words instead of numbers you can also just enter the relevant letter or word into the <mark>Define Success: Value(s):</mark> box to compute the proportion and associated 95% confidence interval for that category level.</p>
</blockquote>
<ul>
<li>All the results we want are in the “One-Sample Proportions Confidence Intervals” table. As you can see the results for each confidence interval method are on a separate row, and you can see which method is on which row under the “Interval Type” column. Under the “Observed” heading there are three columns giving the number of “Successes”, which means the count of observations (i.e.&nbsp;individuals) in the category we selected, the number of “Trials”, which just means the number of observations or the sample size of the variable, and the corresponding “Proportion”. You can of course multiply this by 100 to convert to the percentage scale. We then have the lower and upper 95% confidence intervals under the correspondingly named final two columns. As you can see for this variable and these methods they actually give very similar results, and indeed the method using the normal approximation (“Wald”) is pretty much the same as the other methods. You would see larger differences if estimating proportions nearer 0 or 1.</li>
</ul>
</details>
<p><br></p>
<p>You can check that the results you obtained are correct by revealing the correct results below:</p>
<details>
<summary>
Read/hide
</summary>
<p>For systolic blood pressure we can see that the sample mean systolic blood pressure is 126.5 mmHg, and the 95% confidence intervals indicate that the population mean is likely to be between 124.9 and 128.2 mmHg, which we can compactly write as “mean systolic blood pressure = 126.5 mmHg (95% CI: 124.9, 128.2)”.</p>
<p>Therefore, we have a pretty accurate estimate given the sample size and variability in the outcome values (assuming no bias, which is always a big and unlikely assumption).</p>
<p>For the hypertension prevalence we first need to consider which result to use. While all the results are pretty similar, some evidence suggests that the Wilson Score approach can perform better (give more reliable inferences), so using that result we can see that 25% of individuals (136/543) have hypertension in the sample, and the % in the target population is likely to be between (i.e.&nbsp;the 95% confidence interval is) 21.6% and 28.9%. Again, we can write this compactly as “hypertension prevalence = 25% (95% CI: 21.6%, 28.9%)”.</p>
<p>So again, given our sample size we’ve got quite an accurate estimate of the population parameter (assuming no bias, which is always a big and unlikely assumption).</p>
</details>
</section>
<section id="exercise-2-estimate-means-and-proportionpercentages-and-their-associated-95-confidence-intervals-in-relation-to-subgroups-within-the-target-population" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-estimate-means-and-proportionpercentages-and-their-associated-95-confidence-intervals-in-relation-to-subgroups-within-the-target-population">Exercise 2: estimate means and proportion/percentages and their associated 95% confidence intervals in relation to subgroups within the target population</h2>
<blockquote class="blockquote">
<p>Aim: for women and men estimate the mean systolic blood pressure (mmHg) and the prevalence (%) of hypertension and their associated 95% confidence intervals to allow statistical inferences to be drawn about the typical level of systolic blood pressure and the prevalence of hypertension in these two subgroups within the target population.</p>
</blockquote>
<ul>
<li>We will continue to use the same dataset (“SBP data final.sav), and we will be computing the same measures. The only difference is we will do this separately for women and men. Follow the instructions below, which involve creating new variables before repeating the process from the previous exercise to compute the results of interest.</li>
</ul>
<p><br></p>
<p>Sorry: at present there is no video-based set of instructions for this method.</p>
<p><strong>Written instructions: calculating means, percentages and their 95% confidence intervals for subgroups in SPSS</strong></p>
<details>
<summary>
Read/hide
</summary>
<p><strong>Create new outcome variables for women and men</strong></p>
<ul>
<li><p>We will compute new outcome variables for each subgroup (sex), with the values of the outcomes missing for the subgroup that is not of interest (i.e.&nbsp;the female outcome variable will have missing values for all males in the dataset and vice versa). Then we will just repeat the same process as for exercise 1 to compute our desired measures for each variable, and they will therefore be specific to each subgroup only.</p></li>
<li><p>First we’ll create a new women-only systolic blood pressure variable. From the main menu go <mark>Transform &gt; Compute Variable</mark>.</p></li>
<li><p>Let’s call our new variable “sbp_fm”. In the <mark>Compute Variable</mark> tool window that appears in the <mark>Target Variable</mark> box type “sbp_fm”. Now double click on the <mark>sbp</mark> variable in the variable list. It should appear in the <mark>Numeric Expression</mark> box. If we don’t add any other commands to this logical expression all it’s telling SPSS to do is to create a new variable with the name given in the <mark>Target Variable</mark> box, where the values are just the same values as those in the <mark>sbp</mark> variable. So effectively just copying row-by-row the values from <mark>sbp</mark> and pasting them into <mark>sbp_fm</mark>. However, we only want to do this for those values from the women in the dataset.</p></li>
<li><p>Therefore, next in the bottom left of the tool window click the blue-bordered <mark>If..</mark> button. This is where we will tell SPSS to only copy and paste if the observations are from women. At the top of the tool window select the button that is next to the text <mark>Include if case satisfies condition:</mark>. Double click on the <mark>Sex (male/female)</mark> variable in the variable list. It should appear in the box below the text reading “Include if case satisfies condition:”. Add the text “= 2” so that the full text in the box reads:</p></li>
</ul>
<blockquote class="blockquote">
<p>sex = 2</p>
</blockquote>
<ul>
<li>You can also just copy and paste this command. This is a logical condition telling SPSS to only carry out our logical expression (copying and pasting) for observations where sex = 2. If you right click on the sex variable and select <mark>Variable Information</mark> you can see that this categorical variable is numerically coded and the value 2 represents women.</li>
</ul>
<blockquote class="blockquote">
<p>Note: if you wanted to do this with a categorical variable that was string coded you would just type the relevant string. For example, if the sex variable actually had values of “male” or “female” to select males you would type (including the quotation marks):</p>
</blockquote>
<blockquote class="blockquote">
<p>sex = “male”</p>
</blockquote>
<ul>
<li><p>Finally, click <mark>Continue</mark> to get back to the original tool window and then click <mark>OK</mark>. You should see a new variable appear to the right of your existing variables called <mark>sbp_fm</mark>. If you scroll down you will see that when you get to the men in the dataset the new variable only has missing values. This is what we want.</p></li>
<li><p>Now repeat the above process but call your new variable <mark>sbp_m</mark> and use the following command in the <mark>If..</mark> logical selection part:</p></li>
</ul>
<blockquote class="blockquote">
<p>sex = 1</p>
</blockquote>
<ul>
<li><p>You should now have two new variables for the systolic blood pressure values of just the women and just the men in the dataset.</p></li>
<li><p>You can now repeat this process for the hypertension variable, creating two new variables: one for women’s hypertension outcomes and one for men’s hypertension outcomes.</p></li>
<li><p>You can then repeat the process used in exercise 1 to estimate the mean systolic blood pressure and the % prevalence of hypertension and their associated 95% confidence intervals for women and men separately. Simply use the separate sex-specific systolic blood pressure and hypertension outcome variables that you have created in place of the overall ones you used previously. SPSS will automatically ignore/exclude any missing values, which for each sex-specific outcome variable will include the values for all individuals of the opposite sex.</p></li>
</ul>
</details>
<p><br></p>
<p>You can check that your results match what they should be by revealing the correct results below:</p>
<details>
<summary>
Read/hide
</summary>
<p><strong>Systolic blood pressure (mmHg)</strong></p>
<p><em>Women</em></p>
<ul>
<li>Mean systolic blood pressure = 120.5 mmHg (95% CI: 118.1, 122.8)</li>
</ul>
<p><em>Men</em></p>
<ul>
<li>Mean systolic blood pressure = 132 mmHg (95% CI: 129.7, 134.2)</li>
</ul>
<p><strong>Hypertension (confidence intervals based on Wilson Score method)</strong></p>
<p><em>Women</em></p>
<ul>
<li>% hypertension = 16% (95% CI: 12%, 20.9%)</li>
</ul>
<p><em>Men</em></p>
<ul>
<li>% hypertension = 33.2% (95% CI: 28%, 38.9%)</li>
</ul>
</details>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>